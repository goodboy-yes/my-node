<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.29">
    <title>合成层 | Gkc's notes</title><meta name="description" content="Record knowledge">
    <link rel="modulepreload" href="/my-notes/assets/app.5949ba84.js"><link rel="modulepreload" href="/my-notes/assets/compositing-layer.html.bd063e6f.js"><link rel="modulepreload" href="/my-notes/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/my-notes/assets/compositing-layer.html.8c2d18de.js">
    <link rel="stylesheet" href="/my-notes/assets/style.4b916bd5.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/my-notes/" class=""><!----><span class="site-name can-hide">Gkc&#39;s notes</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a class="nav-link external" href="https://v2.vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress"><!--[--><!--]--> VuePress <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/goodboy-yes/my-node" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a class="nav-link external" href="https://v2.vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress"><!--[--><!--]--> VuePress <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/goodboy-yes/my-node" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">HTML</p><ul class=""><li><!--[--><a href="/my-notes/html/sample-template.html" class="nav-link sidebar-item" aria-label="示例模板"><!--[--><!--]--> 示例模板 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/html/knowledge-points.html" class="nav-link sidebar-item" aria-label="知识点"><!--[--><!--]--> 知识点 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">JS</p><ul class=""><li><!--[--><a href="/my-notes/js/knowledge-points.html" class="nav-link sidebar-item" aria-label="知识点"><!--[--><!--]--> 知识点 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/handwriting-knowledge.html" class="nav-link sidebar-item" aria-label="手写知识点"><!--[--><!--]--> 手写知识点 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/code-snippet.html" class="nav-link sidebar-item" aria-label="小技巧"><!--[--><!--]--> 小技巧 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/bit-operation.html" class="nav-link sidebar-item" aria-label="位运算"><!--[--><!--]--> 位运算 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/regular-expression.html" class="nav-link sidebar-item" aria-label="正则表达式"><!--[--><!--]--> 正则表达式 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/file-operation.html" class="nav-link sidebar-item" aria-label="文件操作"><!--[--><!--]--> 文件操作 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/cross-domain.html" class="nav-link sidebar-item" aria-label="跨域"><!--[--><!--]--> 跨域 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/code-style.html" class="nav-link sidebar-item" aria-label="代码风格"><!--[--><!--]--> 代码风格 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/performance-optimization.html" class="nav-link sidebar-item" aria-label="性能优化"><!--[--><!--]--> 性能优化 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/design-pattern.html" class="nav-link sidebar-item" aria-label="设计模式"><!--[--><!--]--> 设计模式 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/principle-analysis.html" class="nav-link sidebar-item" aria-label="原理分析"><!--[--><!--]--> 原理分析 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">TypeScript</p><ul class=""><li><!--[--><a href="/my-notes/ts/basic-knowledge.html" class="nav-link sidebar-item" aria-label="基础知识"><!--[--><!--]--> 基础知识 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/ts/to-use.html" class="nav-link sidebar-item" aria-label="如何使用"><!--[--><!--]--> 如何使用 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item active">CSS</p><ul class=""><li><!--[--><a href="/my-notes/css/knowledge-points.html" class="nav-link sidebar-item" aria-label="知识点"><!--[--><!--]--> 知识点 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/css/bfc.html" class="nav-link sidebar-item" aria-label="块级格式化上下文(BFC)"><!--[--><!--]--> 块级格式化上下文(BFC) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/css/pseudo-classes-and-elements.html" class="nav-link sidebar-item" aria-label="伪类和伪元素"><!--[--><!--]--> 伪类和伪元素 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/css/aspect-ratio.html" class="nav-link sidebar-item" aria-label="aspect-ratio"><!--[--><!--]--> aspect-ratio <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/css/skill.html" class="nav-link sidebar-item" aria-label="小技巧"><!--[--><!--]--> 小技巧 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/css/compositing-layer.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="合成层"><!--[--><!--]--> 合成层 <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/my-notes/css/compositing-layer.html#浏览器渲染流程" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="浏览器渲染流程"><!--[--><!--]--> 浏览器渲染流程 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/css/compositing-layer.html#什么是合成层" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="什么是合成层"><!--[--><!--]--> 什么是合成层 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/css/compositing-layer.html#关于隐式合成" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="关于隐式合成"><!--[--><!--]--> 关于隐式合成 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/css/compositing-layer.html#合成层的利弊" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="合成层的利弊"><!--[--><!--]--> 合成层的利弊 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/css/compositing-layer.html#合成层的使用" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="合成层的使用"><!--[--><!--]--> 合成层的使用 <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/my-notes/css/compositing-layer.html#使用-transform-实现动画" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="使用 transform 实现动画"><!--[--><!--]--> 使用 transform 实现动画 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/css/compositing-layer.html#谨慎使用-will-change" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="谨慎使用 will-change"><!--[--><!--]--> 谨慎使用 will-change <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/css/compositing-layer.html#减小合成层绘制区域" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="减小合成层绘制区域"><!--[--><!--]--> 减小合成层绘制区域 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Vue2</p><ul class=""><li><!--[--><a href="/my-notes/vue2/knowledge-points.html" class="nav-link sidebar-item" aria-label="知识点"><!--[--><!--]--> 知识点 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/vue2/keep-alive.html" class="nav-link sidebar-item" aria-label="keep-alive"><!--[--><!--]--> keep-alive <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Vue3</p><ul class=""><li><!--[--><a href="/my-notes/vue3/difference-from-vue2.html" class="nav-link sidebar-item" aria-label="与 Vue2 不同点"><!--[--><!--]--> 与 Vue2 不同点 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/vue3/vite.html" class="nav-link sidebar-item" aria-label="Vite"><!--[--><!--]--> Vite <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/vue3/practice.html" class="nav-link sidebar-item" aria-label="实践"><!--[--><!--]--> 实践 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><a href="/my-notes/react" class="nav-link sidebar-heading sidebar-item" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a><ul class=""><li><!--[--><a href="/my-notes/react/use.html" class="nav-link sidebar-item" aria-label="使用"><!--[--><!--]--> 使用 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/react/react-router.html" class="nav-link sidebar-item" aria-label="react-router(V6)"><!--[--><!--]--> react-router(V6) <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><a href="/my-notes/node-js" class="nav-link sidebar-heading sidebar-item" aria-label="Nodejs"><!--[--><!--]--> Nodejs <!--[--><!--]--></a><!----><!--]--><!--[--><p class="sidebar-heading sidebar-item">Git</p><ul class=""><li><!--[--><a href="/my-notes/git/basic-command.html" class="nav-link sidebar-item" aria-label="命令"><!--[--><!--]--> 命令 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/git/commit-standard.html" class="nav-link sidebar-item" aria-label="commit 规范"><!--[--><!--]--> commit 规范 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/git/reset-and-revert.html" class="nav-link sidebar-item" aria-label="git reset 和 git revert 的区别"><!--[--><!--]--> git reset 和 git revert 的区别 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/git/commit-amend.html" class="nav-link sidebar-item" aria-label="git commit --amend"><!--[--><!--]--> git commit --amend <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Webpack</p><ul class=""><li><!--[--><a href="/my-notes/webpack/principle-analysis.html" class="nav-link sidebar-item" aria-label="原理分析"><!--[--><!--]--> 原理分析 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">开发实践</p><ul class=""><li><!--[--><a href="/my-notes/development-practice/functional-programming.html" class="nav-link sidebar-item" aria-label="函数式编程"><!--[--><!--]--> 函数式编程 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/development-practice/refactoring.html" class="nav-link sidebar-item" aria-label="重构"><!--[--><!--]--> 重构 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/development-practice/interactive.html" class="nav-link sidebar-item" aria-label="交互设计"><!--[--><!--]--> 交互设计 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/development-practice/technical-scheme.html" class="nav-link sidebar-item" aria-label="技术方案"><!--[--><!--]--> 技术方案 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">知识点</p><ul class=""><li><!--[--><a href="/my-notes/knowledge-point/algorithm.html" class="nav-link sidebar-item" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/knowledge-point/network.html" class="nav-link sidebar-item" aria-label="网络"><!--[--><!--]--> 网络 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><a href="/my-notes/development-proposals" class="nav-link sidebar-heading sidebar-item" aria-label="发展建议"><!--[--><!--]--> 发展建议 <!--[--><!--]--></a><!----><!--]--><!--[--><a href="/my-notes/vs-code" class="nav-link sidebar-heading sidebar-item" aria-label="VSCode"><!--[--><!--]--> VSCode <!--[--><!--]--></a><!----><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="合成层" tabindex="-1"><a class="header-anchor" href="#合成层" aria-hidden="true">#</a> 合成层</h1><h2 id="浏览器渲染流程" tabindex="-1"><a class="header-anchor" href="#浏览器渲染流程" aria-hidden="true">#</a> 浏览器渲染流程</h2><ul><li>浏览器下载并解析 HTML。</li><li>构建 CSSOM 树和 DOM 树。</li><li>DOM 与 CSSOM 合并成一个 Render 树。</li><li>有了 Render Tree，浏览器可以知道各个节点的 CSS 定义以及他们的从属关系，从而去计算出每个节点在屏幕中的位置，生成一个足够大的画布来容纳所有元素。</li><li>根据浏览器提供各层的信息合成图层，显示到屏幕上，合成图层中一些特殊的图层被认为是<strong>合成层（Compositing Layers）</strong></li></ul><h2 id="什么是合成层" tabindex="-1"><a class="header-anchor" href="#什么是合成层" aria-hidden="true">#</a> 什么是合成层</h2><p>首先合成就是将页面的各个部分分成多个层、单独光栅化（浏览器根据文档的结构、每个元素的样式、页面的几何形状和绘制顺序转换为屏幕上的像素的过程）它们并在合成器线程中合成为一个页面的技术。</p><p>在 Chrome 开发工具中打开自定义菜单，然后在 More tools 中选择 Layers 选项可以看到当前页面的图层结构</p><p>一些特定属性的渲染层，会被浏览器自动提升为合成层。合成层拥有单独的图层（GraphicsLayer），和其他图层之间无不影响。而其它不是合成层的渲染层，则和第一个拥有图层的父层共用一个，也就是普通文档流中的内容</p><p>下面是一些常见的提升为合成层的属性：</p><ul><li>设置 <code>transform: translateZ(0)</code>，注意它必须是 <code>translateZ</code>，因为它使用 GPU 来计算 <code>perspective distortion</code>（透视失真）。<code>perspective</code> 在 3D 设计中是一个重要的属性，如果你使用 <code>translateX</code> 或 <code>translateY</code>，元素将会被绘制在普通文档流中</li><li><code>backface-visibility: hidden</code> 指定当元素背面朝向观察者时是否可见。</li><li><code>will-change</code> 该属性告诉浏览器该元素会有哪些变化，这样浏览器可以提前做好对应的优化准备工作。当该属性的值为 <code>opacity</code>、<code>transform</code>、<code>top</code>、<code>left</code>、<code>bottom</code>、<code>right</code> 时。</li><li><code>video</code>、<code>canvas</code>、<code>iframe</code> 等元素。</li></ul><h2 id="关于隐式合成" tabindex="-1"><a class="header-anchor" href="#关于隐式合成" aria-hidden="true">#</a> 关于隐式合成</h2><p>一个或多个非合成元素应出现在堆叠顺序上的合成元素之上，会被提升为合成层。如果多个渲染层同一个合成层重叠时，这些渲染层会被压缩到一个图层中，以防止由于重叠原因导致出现的层爆炸</p><p>如下面的示例，#C 设置了 will-change 被提升为合成层，#A 和#B 的 index 属性比#C 大并且与其重叠，#A 和#B 会提升为一个合成层</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
      <span class="token selector">#A,
      #B,
      #C</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
        <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">#C</span> <span class="token punctuation">{</span>
        <span class="token property">left</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
        <span class="token property">top</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
        <span class="token property">z-index</span><span class="token punctuation">:</span> 100<span class="token punctuation">;</span>
        <span class="token property">will-change</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
        <span class="token property">animation</span><span class="token punctuation">:</span> move 1s linear<span class="token punctuation">;</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">#A</span> <span class="token punctuation">{</span>
        <span class="token property">z-index</span><span class="token punctuation">:</span> 200<span class="token punctuation">;</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">#B</span> <span class="token punctuation">{</span>
        <span class="token property">left</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
        <span class="token property">top</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
        <span class="token property">z-index</span><span class="token punctuation">:</span> 200<span class="token punctuation">;</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> yellow<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token atrule"><span class="token rule">@keyframes</span> move</span> <span class="token punctuation">{</span>
        <span class="token selector">form</span> <span class="token punctuation">{</span>
          <span class="token property">left</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token selector">to</span> <span class="token punctuation">{</span>
          <span class="token property">left</span><span class="token punctuation">:</span> 150px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>A<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>B<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>B<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>C<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>C<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h2 id="合成层的利弊" tabindex="-1"><a class="header-anchor" href="#合成层的利弊" aria-hidden="true">#</a> 合成层的利弊</h2><p>渲染层的提示带来的好处：</p><ul><li>开启硬件加速，合成层的位图会交由 GPU 合成，相比 CPU 处理要快。</li><li>合成层发生 repaint 的时候，不会影响其他图层。</li><li>对于 transform 和 opacity 效果，不会触发 layout 和 paint。</li></ul><p>当然合成层也存在一些问题：</p><ul><li>如果我们把所有渲染工作都交给 GPU，在现有的优化下，它会导致渲染内存占用比大幅度提升，反而出现负面的效果。</li><li>另外隐式合成容易产生大量我们意料之外的合成层，过大的内存占用，会让页面变的卡顿，性能优化适得其反。</li></ul><h2 id="合成层的使用" tabindex="-1"><a class="header-anchor" href="#合成层的使用" aria-hidden="true">#</a> 合成层的使用</h2><h3 id="使用-transform-实现动画" tabindex="-1"><a class="header-anchor" href="#使用-transform-实现动画" aria-hidden="true">#</a> 使用 transform 实现动画</h3><p>在我们日常开发中经常会实现一些动画，有时候我们可能会选择改变 <code>top/left</code> 去实现，那么这个节点的渲染会发生在普通文档流中。而使用 <code>transform</code> 和 <code>opacity</code> 实现动画能够让节点被放置到一个独立合成层中进行渲染绘制，动画不会影响其他图层，并且 GPU 渲染相比 CPU 能够更快，这会让你的动画变的更加流畅</p><p>如果你无法确定使用这个属性是否合理，在你将任何 CSS 属性用于实现动画之前，你可以在 <a href="https://csstriggers.com/" target="_blank" rel="noopener noreferrer">csstriggers<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 上查看该属性对渲染管道的影响。</p><p><img src="/my-notes/assets/css-triggers.2119201d.png" alt="css-triggers"></p><h3 id="谨慎使用-will-change" tabindex="-1"><a class="header-anchor" href="#谨慎使用-will-change" aria-hidden="true">#</a> 谨慎使用 will-change</h3><p>除非你的元素的真的存在某个属性马上会发生变化，例如 <code>transform</code>，你可以使用 <code>will-change: transform</code> 告知浏览器，根据您打算更改的元素，浏览器可能可以预先安排，元素的改变和渲染速度都会变得更快。</p><p>可是这些属性可能会给你带来一些副作用，**任何带有 <code>position: fixed</code> 或者 <code>position: absolute</code> 的子元素将会相对于设置了 <code>will-change: transform</code> 的元素进行相对定位。**除此之外浏览器用来为 <code>will-change</code> 属性做的更进一步的优化常常会耗费更多的资源，如果你将它施加在过多属性上显然是一个浪费，更甚者非常过度的使用可能会造成页面相应速度的变慢或者直接崩溃。</p><h3 id="减小合成层绘制区域" tabindex="-1"><a class="header-anchor" href="#减小合成层绘制区域" aria-hidden="true">#</a> 减小合成层绘制区域</h3><p>合成层的绘制区域大小，很大程度上影响了它的内存占用。 我们可以设置小的尺寸，通过 <code>transform: scale()</code>在用户看不到任何区别的前提下节省大量的内存。</p><blockquote><p>参考链接：<a href="https://mp.weixin.qq.com/s?__biz=MzI1NTg3NzcwNQ==&amp;mid=2247485354&amp;idx=1&amp;sn=32bbe6790588f0d5cdc438a4402cbd55&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">浏览器渲染魔法之合成层<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p></blockquote><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: gkckx37@163.com">goodboy-yes</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/my-notes/css/skill.html" class="nav-link" aria-label="小技巧"><!--[--><!--]--> 小技巧 <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/my-notes/assets/app.5949ba84.js" defer></script>
  </body>
</html>
