<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.8" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <title>代码规范 | Gkc's notes</title><meta name="description" content="Record knowledge">
    <link rel="preload" href="/my-notes/assets/style-DUHaMXWK.css" as="style"><link rel="stylesheet" href="/my-notes/assets/style-DUHaMXWK.css">
    <link rel="modulepreload" href="/my-notes/assets/app-CtA61ec0.js"><link rel="modulepreload" href="/my-notes/assets/code-standard.html-D0wO6ds2.js">
    <link rel="prefetch" href="/my-notes/assets/index.html-ipFAqpj6.js" as="script"><link rel="prefetch" href="/my-notes/assets/index.html-GVXXwK1P.js" as="script"><link rel="prefetch" href="/my-notes/assets/aspect-ratio.html-Clk62qne.js" as="script"><link rel="prefetch" href="/my-notes/assets/bfc.html-C0AQH_92.js" as="script"><link rel="prefetch" href="/my-notes/assets/compositing-layer.html-CJd4ht61.js" as="script"><link rel="prefetch" href="/my-notes/assets/knowledge-points.html-eeIXR9-N.js" as="script"><link rel="prefetch" href="/my-notes/assets/pseudo-classes-and-elements.html-DYvGcPj9.js" as="script"><link rel="prefetch" href="/my-notes/assets/skill.html-0RFnwmEm.js" as="script"><link rel="prefetch" href="/my-notes/assets/array.html-CBTuQjO3.js" as="script"><link rel="prefetch" href="/my-notes/assets/complexity-analysis.html-DbuMknEn.js" as="script"><link rel="prefetch" href="/my-notes/assets/linked-list.html-BnzctXsJ.js" as="script"><link rel="prefetch" href="/my-notes/assets/stack.html-CfEzbRSx.js" as="script"><link rel="prefetch" href="/my-notes/assets/functional-programming.html-N-j1Y5v6.js" as="script"><link rel="prefetch" href="/my-notes/assets/interactive.html-CqcVdf51.js" as="script"><link rel="prefetch" href="/my-notes/assets/refactoring.html-DLisCKNg.js" as="script"><link rel="prefetch" href="/my-notes/assets/technical-scheme.html-DAVqwfbo.js" as="script"><link rel="prefetch" href="/my-notes/assets/index.html-BHAhvIMS.js" as="script"><link rel="prefetch" href="/my-notes/assets/index.html-BsICCCW4.js" as="script"><link rel="prefetch" href="/my-notes/assets/basic-command.html-2gNWikgV.js" as="script"><link rel="prefetch" href="/my-notes/assets/commit-amend.html-BNxrMYW5.js" as="script"><link rel="prefetch" href="/my-notes/assets/commit-standard.html-DHymmGac.js" as="script"><link rel="prefetch" href="/my-notes/assets/git-rebase.html-QDKNRsKi.js" as="script"><link rel="prefetch" href="/my-notes/assets/reset-and-revert.html-CtawU7Zf.js" as="script"><link rel="prefetch" href="/my-notes/assets/knowledge-points.html-DQD92EgF.js" as="script"><link rel="prefetch" href="/my-notes/assets/sample-template.html-ATIbb8bK.js" as="script"><link rel="prefetch" href="/my-notes/assets/bit-operation.html-BNAUmsLC.js" as="script"><link rel="prefetch" href="/my-notes/assets/code-snippet.html-BQBWmx_2.js" as="script"><link rel="prefetch" href="/my-notes/assets/code-style.html-DEYm0QgC.js" as="script"><link rel="prefetch" href="/my-notes/assets/cross-domain.html-DDd7DWOw.js" as="script"><link rel="prefetch" href="/my-notes/assets/design-pattern.html-C9RE6rrm.js" as="script"><link rel="prefetch" href="/my-notes/assets/file-operation.html-BRZ0BRWO.js" as="script"><link rel="prefetch" href="/my-notes/assets/handwriting-knowledge.html-BkXRsk49.js" as="script"><link rel="prefetch" href="/my-notes/assets/knowledge-points.html-Bq-iUUkP.js" as="script"><link rel="prefetch" href="/my-notes/assets/performance-optimization.html-Bc6KLPKr.js" as="script"><link rel="prefetch" href="/my-notes/assets/principle-analysis.html-DoZzhFrk.js" as="script"><link rel="prefetch" href="/my-notes/assets/regular-expression.html-jPfWQsMa.js" as="script"><link rel="prefetch" href="/my-notes/assets/algorithm.html-C6omsHZo.js" as="script"><link rel="prefetch" href="/my-notes/assets/character-encoding.html-BSredrld.js" as="script"><link rel="prefetch" href="/my-notes/assets/network.html-DTW1SgvS.js" as="script"><link rel="prefetch" href="/my-notes/assets/index.html-DqmKw5H_.js" as="script"><link rel="prefetch" href="/my-notes/assets/ahooks.html-ChSPSDgl.js" as="script"><link rel="prefetch" href="/my-notes/assets/api.html-BOO3Hfqi.js" as="script"><link rel="prefetch" href="/my-notes/assets/dva.html-CnOEHzsl.js" as="script"><link rel="prefetch" href="/my-notes/assets/react-router.html-DKs9FxEK.js" as="script"><link rel="prefetch" href="/my-notes/assets/redux.html-_4GP1ALl.js" as="script"><link rel="prefetch" href="/my-notes/assets/umijs.html-CvB2llRx.js" as="script"><link rel="prefetch" href="/my-notes/assets/use.html-BVtxr91Y.js" as="script"><link rel="prefetch" href="/my-notes/assets/basic-knowledge.html-C4yL1Zrs.js" as="script"><link rel="prefetch" href="/my-notes/assets/to-use.html-C2g_myRx.js" as="script"><link rel="prefetch" href="/my-notes/assets/index.html-CNejeD2D.js" as="script"><link rel="prefetch" href="/my-notes/assets/keep-alive.html-d0e2Gumn.js" as="script"><link rel="prefetch" href="/my-notes/assets/knowledge-points.html-DtnbvPNU.js" as="script"><link rel="prefetch" href="/my-notes/assets/difference-from-vue2.html-BI4Aw0iA.js" as="script"><link rel="prefetch" href="/my-notes/assets/practice.html-dzaN7wa8.js" as="script"><link rel="prefetch" href="/my-notes/assets/style-guide.html-DR63GSlr.js" as="script"><link rel="prefetch" href="/my-notes/assets/vite.html-AhsAsVDV.js" as="script"><link rel="prefetch" href="/my-notes/assets/principle-analysis.html-DvG5Sbik.js" as="script"><link rel="prefetch" href="/my-notes/assets/develop.html-B_GV5JLK.js" as="script"><link rel="prefetch" href="/my-notes/assets/introduction.html-Bds4kxIl.js" as="script"><link rel="prefetch" href="/my-notes/assets/404.html-z1dv-LzL.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/my-notes/"><img class="logo" src="https://v2.vuepress.vuejs.org/images/hero.png" alt="Gkc&#39;s notes"><span class="site-name can-hide" aria-hidden="true">Gkc&#39;s notes</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><a class="external-link" href="https://v2.vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress"><!--[--><!--]--> VuePress <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/goodboy-yes/my-node" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><a class="external-link" href="https://v2.vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress"><!--[--><!--]--> VuePress <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/goodboy-yes/my-node" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">HTML <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/html/sample-template.html" aria-label="示例模板"><!--[--><!--]--> 示例模板 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/html/knowledge-points.html" aria-label="知识点"><!--[--><!--]--> 知识点 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">JS <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/js/knowledge-points.html" aria-label="知识点"><!--[--><!--]--> 知识点 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/js/handwriting-knowledge.html" aria-label="手写知识点"><!--[--><!--]--> 手写知识点 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/js/code-snippet.html" aria-label="小技巧"><!--[--><!--]--> 小技巧 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/js/bit-operation.html" aria-label="位运算"><!--[--><!--]--> 位运算 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/js/regular-expression.html" aria-label="正则表达式"><!--[--><!--]--> 正则表达式 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/js/file-operation.html" aria-label="文件操作"><!--[--><!--]--> 文件操作 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/js/cross-domain.html" aria-label="跨域"><!--[--><!--]--> 跨域 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/js/code-style.html" aria-label="代码风格"><!--[--><!--]--> 代码风格 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/js/performance-optimization.html" aria-label="性能优化"><!--[--><!--]--> 性能优化 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/js/design-pattern.html" aria-label="设计模式"><!--[--><!--]--> 设计模式 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/js/principle-analysis.html" aria-label="原理分析"><!--[--><!--]--> 原理分析 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">TypeScript <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/ts/basic-knowledge.html" aria-label="基础知识"><!--[--><!--]--> 基础知识 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/ts/to-use.html" aria-label="如何使用"><!--[--><!--]--> 如何使用 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">CSS <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/css/knowledge-points.html" aria-label="知识点"><!--[--><!--]--> 知识点 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/css/bfc.html" aria-label="块级格式化上下文(BFC)"><!--[--><!--]--> 块级格式化上下文(BFC) <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/css/pseudo-classes-and-elements.html" aria-label="伪类和伪元素"><!--[--><!--]--> 伪类和伪元素 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/css/aspect-ratio.html" aria-label="aspect-ratio"><!--[--><!--]--> aspect-ratio <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/css/skill.html" aria-label="小技巧"><!--[--><!--]--> 小技巧 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/css/compositing-layer.html" aria-label="合成层"><!--[--><!--]--> 合成层 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Vue2 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/vue2/knowledge-points.html" aria-label="知识点"><!--[--><!--]--> 知识点 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/vue2/keep-alive.html" aria-label="keep-alive"><!--[--><!--]--> keep-alive <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Vue3 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/vue3/difference-from-vue2.html" aria-label="与 Vue2 不同点"><!--[--><!--]--> 与 Vue2 不同点 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/vue3/vite.html" aria-label="Vite"><!--[--><!--]--> Vite <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/vue3/practice.html" aria-label="实践"><!--[--><!--]--> 实践 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/vue3/style-guide.html" aria-label="风格指南"><!--[--><!--]--> 风格指南 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">React <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/react/use.html" aria-label="使用"><!--[--><!--]--> 使用 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/react/api.html" aria-label="API"><!--[--><!--]--> API <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/react/react-router.html" aria-label="react-router(V6)"><!--[--><!--]--> react-router(V6) <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/react/umijs.html" aria-label="umijs"><!--[--><!--]--> umijs <!--[--><!--]--></a><!----></li><li><a class="route-link route-link-active sidebar-item active" href="/my-notes/react/code-standard.html" aria-label="代码规范"><!--[--><!--]--> 代码规范 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/#react-或组件相关" aria-label="React 或组件相关"><!--[--><!--]--> React 或组件相关 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/#使用函数组件-拥抱-hooks" aria-label="使⽤函数组件，拥抱 Hooks"><!--[--><!--]--> 使⽤函数组件，拥抱 Hooks <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#保证-react-组件的调用参数-props-类型声明和注释" aria-label="保证 React 组件的调⽤参数 props 类型声明和注释"><!--[--><!--]--> 保证 React 组件的调⽤参数 props 类型声明和注释 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#props-只传递必要的属性-否则容易混淆-且会造成子组件的冗余刷新。" aria-label="props 只传递必要的属性，否则容易混淆，且会造成⼦组件的冗余刷新。"><!--[--><!--]--> props 只传递必要的属性，否则容易混淆，且会造成⼦组件的冗余刷新。 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#如果-jsx-属性值为-true-可以直接省略-自闭合标签应该简写" aria-label="如果 JSX 属性值为 true ，可以直接省略，自闭合标签应该简写"><!--[--><!--]--> 如果 JSX 属性值为 true ，可以直接省略，自闭合标签应该简写 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#react-组件循环时需要唯一-key" aria-label="React 组件循环时需要唯⼀ key"><!--[--><!--]--> React 组件循环时需要唯⼀ key <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#组件间相互屏蔽隐藏细节-然后选择恰当的通信方式" aria-label="组件间相互屏蔽隐藏细节，然后选择恰当的通信⽅式"><!--[--><!--]--> 组件间相互屏蔽隐藏细节，然后选择恰当的通信⽅式 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/my-notes/#hooks-相关" aria-label="Hooks 相关"><!--[--><!--]--> Hooks 相关 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/#谨慎使用-usestate-使用-usememo-缓存值" aria-label="谨慎使⽤ useState，使⽤ useMemo 缓存值"><!--[--><!--]--> 谨慎使⽤ useState，使⽤ useMemo 缓存值 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#使用-ahooks" aria-label="使用 ahooks"><!--[--><!--]--> 使用 ahooks <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#使用更加语义化的-useboolean" aria-label="使⽤更加语义化的 useBoolean"><!--[--><!--]--> 使⽤更加语义化的 useBoolean <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/my-notes/#ts-相关" aria-label="TS 相关"><!--[--><!--]--> TS 相关 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/#类型的精确是有价值的-类型声明是尽量语义化和缩小范围" aria-label="类型的精确是有价值的，类型声明是尽量语义化和缩⼩范围"><!--[--><!--]--> 类型的精确是有价值的，类型声明是尽量语义化和缩⼩范围 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#避免使用-any" aria-label="避免使⽤ any"><!--[--><!--]--> 避免使⽤ any <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#大量类型声明单独写在-types-ts" aria-label="大量类型声明单独写在 types.ts"><!--[--><!--]--> 大量类型声明单独写在 types.ts <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#善用-ts-工具类型" aria-label="善⽤ TS ⼯具类型"><!--[--><!--]--> 善⽤ TS ⼯具类型 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#引入-类型-需要使用-import-type" aria-label="引⼊&#39;类型&#39;需要使⽤ import type"><!--[--><!--]--> 引⼊&#39;类型&#39;需要使⽤ import type <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#data-onetype-undefined-与-data-onetype" aria-label="data: OneType | undefined 与 data?: OneType"><!--[--><!--]--> data: OneType | undefined 与 data?: OneType <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#利用-可辨识联合-never-类型-实现分支流程的完整性检查" aria-label="利⽤ 可辨识联合 + never 类型，实现分⽀流程的完整性检查"><!--[--><!--]--> 利⽤ 可辨识联合 + never 类型，实现分⽀流程的完整性检查 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/my-notes/#ecma-函数相关" aria-label="ECMA,函数相关"><!--[--><!--]--> ECMA,函数相关 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/#使用-和-安全取值" aria-label="使用.?和??安全取值"><!--[--><!--]--> 使用.?和??安全取值 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#谨慎对待循环-尤其是嵌套的循环" aria-label="谨慎对待循环，尤其是嵌套的循环"><!--[--><!--]--> 谨慎对待循环，尤其是嵌套的循环 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#善用结构" aria-label="善用结构"><!--[--><!--]--> 善用结构 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#不要构造成-undefined-的结构" aria-label="不要构造成 [&#39;&#39;] [undefined] 的结构"><!--[--><!--]--> 不要构造成 [&#39;&#39;] [undefined] 的结构 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#使用-占位无用参数" aria-label="使用“_”占位无用参数"><!--[--><!--]--> 使用“_”占位无用参数 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#过滤对象中的属性" aria-label="过滤对象中的属性"><!--[--><!--]--> 过滤对象中的属性 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#善用lodash库" aria-label="善用lodash库"><!--[--><!--]--> 善用lodash库 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#统一函数的-return-行为" aria-label="统⼀函数的 return ⾏为"><!--[--><!--]--> 统⼀函数的 return ⾏为 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#函数式编程" aria-label="函数式编程"><!--[--><!--]--> 函数式编程 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#错误边界" aria-label="错误边界"><!--[--><!--]--> 错误边界 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/my-notes/#service-相关" aria-label="Service 相关"><!--[--><!--]--> Service 相关 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/#关于请求相关的内容需单独写在-services-ts-文件-便于维护" aria-label="关于请求相关的内容需单独写在 services.ts ⽂件，便于维护"><!--[--><!--]--> 关于请求相关的内容需单独写在 services.ts ⽂件，便于维护 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#请求参数格式化或处理" aria-label="请求参数格式化或处理"><!--[--><!--]--> 请求参数格式化或处理 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#请求时判断参数避免重复请求" aria-label="请求时判断参数避免重复请求"><!--[--><!--]--> 请求时判断参数避免重复请求 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#完善-service-文件里请求方法参数类型和返回值类型" aria-label="完善 Service 文件里请求方法参数类型和返回值类型"><!--[--><!--]--> 完善 Service 文件里请求方法参数类型和返回值类型 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#ahooks-userequest" aria-label="ahooks.useRequest"><!--[--><!--]--> ahooks.useRequest <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/my-notes/#model-相关" aria-label="Model 相关"><!--[--><!--]--> Model 相关 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/#独立的-model-ts" aria-label="独立的 model.ts"><!--[--><!--]--> 独立的 model.ts <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#使用createevamodel" aria-label="使用createEvaModel"><!--[--><!--]--> 使用createEvaModel <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#reducers-和-effects" aria-label="reducers 和 effects"><!--[--><!--]--> reducers 和 effects <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#保证状态最小化" aria-label="保证状态最⼩化"><!--[--><!--]--> 保证状态最⼩化 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#确保更新的数据已初始化" aria-label="确保更新的数据已初始化"><!--[--><!--]--> 确保更新的数据已初始化 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/my-notes/#其余代码优化" aria-label="其余代码优化"><!--[--><!--]--> 其余代码优化 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/#抽离配置代码" aria-label="抽离配置代码"><!--[--><!--]--> 抽离配置代码 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#moment" aria-label="moment"><!--[--><!--]--> moment <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#命名" aria-label="命名"><!--[--><!--]--> 命名 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#字符串硬编码定义为配置" aria-label="字符串硬编码定义为配置"><!--[--><!--]--> 字符串硬编码定义为配置 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#使用-map-数据结构优化数组查找" aria-label="使⽤ Map 数据结构优化数组查找"><!--[--><!--]--> 使⽤ Map 数据结构优化数组查找 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#定义断言函数" aria-label="定义断⾔函数"><!--[--><!--]--> 定义断⾔函数 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#提前-return-减少嵌套层级" aria-label="提前 return 减少嵌套层级"><!--[--><!--]--> 提前 return 减少嵌套层级 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#巧用柯里化函数" aria-label="巧⽤柯⾥化函数"><!--[--><!--]--> 巧⽤柯⾥化函数 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/my-notes/#antd-使用相关" aria-label="Antd 使⽤相关"><!--[--><!--]--> Antd 使⽤相关 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/#使用非受控组件" aria-label="使⽤⾮受控组件"><!--[--><!--]--> 使⽤⾮受控组件 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#该使用-form-统一操作" aria-label="该使⽤ Form 统⼀操作"><!--[--><!--]--> 该使⽤ Form 统⼀操作 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#模态窗-modal-自己维护状态" aria-label="模态窗 Modal 自己维护状态"><!--[--><!--]--> 模态窗 Modal 自己维护状态 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#disabled-和-loading" aria-label="disabled 和 loading"><!--[--><!--]--> disabled 和 loading <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/#select-使用-options-配置子项" aria-label="Select 使⽤ options 配置⼦项"><!--[--><!--]--> Select 使⽤ options 配置⼦项 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/my-notes/react/redux.html" aria-label="redux"><!--[--><!--]--> redux <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/react/dva.html" aria-label="dva"><!--[--><!--]--> dva <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/react/ahooks.html" aria-label="ahooks"><!--[--><!--]--> ahooks <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item sidebar-heading" href="/my-notes/node-js.html" aria-label="Nodejs"><!--[--><!--]--> Nodejs <!--[--><!--]--></a><!----></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Git <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/git/basic-command.html" aria-label="用法"><!--[--><!--]--> 用法 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/git/commit-standard.html" aria-label="commit 规范"><!--[--><!--]--> commit 规范 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/git/reset-and-revert.html" aria-label="git reset 和 git revert 的区别"><!--[--><!--]--> git reset 和 git revert 的区别 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/git/commit-amend.html" aria-label="git commit --amend"><!--[--><!--]--> git commit --amend <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/git/git-rebase.html" aria-label="git rebase -i 交互式变基"><!--[--><!--]--> git rebase -i 交互式变基 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Webpack <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/webpack/principle-analysis.html" aria-label="原理分析"><!--[--><!--]--> 原理分析 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">微信小程序 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/winxin-miniprogram/introduction.html" aria-label="介绍"><!--[--><!--]--> 介绍 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/winxin-miniprogram/develop.html" aria-label="开发"><!--[--><!--]--> 开发 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">数据结构与算法 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/dataStructure-algorithms/complexity-analysis.html" aria-label="复杂度分析"><!--[--><!--]--> 复杂度分析 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/dataStructure-algorithms/array.html" aria-label="数组"><!--[--><!--]--> 数组 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/dataStructure-algorithms/linked-list.html" aria-label="链表"><!--[--><!--]--> 链表 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/dataStructure-algorithms/stack.html" aria-label="栈"><!--[--><!--]--> 栈 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">开发实践 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/development-practice/functional-programming.html" aria-label="函数式编程"><!--[--><!--]--> 函数式编程 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/development-practice/refactoring.html" aria-label="重构"><!--[--><!--]--> 重构 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/development-practice/interactive.html" aria-label="交互设计"><!--[--><!--]--> 交互设计 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/development-practice/technical-scheme.html" aria-label="技术方案"><!--[--><!--]--> 技术方案 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">知识点 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/my-notes/knowledge-point/algorithm.html" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/knowledge-point/network.html" aria-label="网络"><!--[--><!--]--> 网络 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/my-notes/knowledge-point/character-encoding.html" aria-label="字符编码"><!--[--><!--]--> 字符编码 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item sidebar-heading" href="/my-notes/development-proposals.html" aria-label="发展建议"><!--[--><!--]--> 发展建议 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item sidebar-heading" href="/my-notes/vs-code.html" aria-label="VSCode"><!--[--><!--]--> VSCode <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item sidebar-heading" href="/my-notes/docker.html" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item sidebar-heading" href="/my-notes/collection.html" aria-label="收藏"><!--[--><!--]--> 收藏 <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="代码规范" tabindex="-1"><a class="header-anchor" href="#代码规范"><span>代码规范</span></a></h1><h2 id="react-或组件相关" tabindex="-1"><a class="header-anchor" href="#react-或组件相关"><span>React 或组件相关</span></a></h2><h3 id="使用函数组件-拥抱-hooks" tabindex="-1"><a class="header-anchor" href="#使用函数组件-拥抱-hooks"><span>使⽤函数组件，拥抱 Hooks</span></a></h3><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 不推荐</span>
<span class="token keyword">class</span> <span class="token class-name">Square</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>button className<span class="token operator">=</span><span class="token string">&quot;square&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>value<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 推荐</span>
<span class="token keyword">const</span> <span class="token literal-property property">Index</span><span class="token operator">:</span> <span class="token constant">FC</span><span class="token operator">&lt;</span><span class="token punctuation">{</span> <span class="token literal-property property">eleList</span><span class="token operator">:</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> eleList <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 各种hooks处理</span>
  <span class="token comment">// JSX处理</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Spin<span class="token operator">&gt;</span><span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>Spin<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Space<span class="token operator">&gt;</span><span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>Space<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">memo</span><span class="token punctuation">(</span>Index<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// memo 是可选的，如果组件复杂可以加上</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="保证-react-组件的调用参数-props-类型声明和注释" tabindex="-1"><a class="header-anchor" href="#保证-react-组件的调用参数-props-类型声明和注释"><span>保证 React 组件的调⽤参数 props 类型声明和注释</span></a></h3><div class="language-jsx line-numbers-mode" data-ext="jsx" data-title="jsx"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token literal-property property">Index</span><span class="token operator">:</span> <span class="token constant">FC</span><span class="token operator">&lt;</span><span class="token punctuation">{</span>
  <span class="token literal-property property">form</span><span class="token operator">:</span> any<span class="token punctuation">,</span> <span class="token comment">// 表单对象</span>
  <span class="token literal-property property">editable</span><span class="token operator">:</span> boolean<span class="token punctuation">,</span> <span class="token comment">// 是否可编辑</span>
  <span class="token function-variable function">setDataSource</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token function-variable function">cb</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">org</span><span class="token operator">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
  <span class="token literal-property property">columns</span><span class="token operator">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dataSource</span><span class="token operator">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> editable<span class="token punctuation">,</span> columns<span class="token punctuation">,</span> dataSource<span class="token punctuation">,</span> setDataSource<span class="token punctuation">,</span> form <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="props-只传递必要的属性-否则容易混淆-且会造成子组件的冗余刷新。" tabindex="-1"><a class="header-anchor" href="#props-只传递必要的属性-否则容易混淆-且会造成子组件的冗余刷新。"><span>props 只传递必要的属性，否则容易混淆，且会造成⼦组件的冗余刷新。</span></a></h3><div class="language-jsx line-numbers-mode" data-ext="jsx" data-title="jsx"><pre class="language-jsx"><code><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      /* 需要什么传什么 */
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Child</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="如果-jsx-属性值为-true-可以直接省略-自闭合标签应该简写" tabindex="-1"><a class="header-anchor" href="#如果-jsx-属性值为-true-可以直接省略-自闭合标签应该简写"><span>如果 JSX 属性值为 true ，可以直接省略，自闭合标签应该简写</span></a></h3><div class="language-jsx line-numbers-mode" data-ext="jsx" data-title="jsx"><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Foo</span></span> <span class="token attr-name">hidden</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token comment">//改为</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Foo</span></span> <span class="token attr-name">hidden</span> <span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Foo</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Foo</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">// 改为</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Foo</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="react-组件循环时需要唯一-key" tabindex="-1"><a class="header-anchor" href="#react-组件循环时需要唯一-key"><span>React 组件循环时需要唯⼀ key</span></a></h3><p>Key 告诉 React 每个组件对应哪个数组项，唯一标识一个组件，帮助 React 识别哪些元素改变了。如果数组项可以移动（例如由于排序）、被插入或被删除，这将变得很重要。一个好的<code>key</code>选择有助于 React 推断到底发生了什么，并对 DOM 树进行正确的更新。</p><p>key 规则：</p><ul><li>同级之间的键必须是唯一的。但是，可以对不同数组中的 JSX 节点使用相同的键。</li><li>密钥不得更改！不要在渲染时生成它们。这将导致渲染之间的键永远不会匹配，从而导致每次都重新创建所有组件和 DOM。这不仅速度慢，而且还会丢失列表项中的任何用户输入。请使用基于数据的稳定 ID。</li></ul><p><strong>不推荐使⽤ index 作为 key</strong></p><p>元素不进行重新排序时可以使用元素在数组中的下标 index 作为 key。如果循环中出现动态删除、插⼊或重新排序元素，使用 index 会错位，diff 会变慢，导致性能变差，还可能引起组件状态的问题。</p><p>由于<strong>组件实例是基于它们的 key 来决定是否更新以及复用</strong>，如果 key 是一个下标，那么修改顺序时会修改当前的 key，导致非受控组件的 state（比如输入框）可能相互篡改，会出现无法预期的变动。</p><p>如果循环项中确定没有唯⼀的属性，推荐使⽤ lodash 的 uniqueId()。但是有个注意点，需要稳定 key 的场景，⽐如 Table 涉及到单元格合并，勾选⾏等，需要直接使⽤到 key 的场景，不能使⽤ uniqueId()</p><h3 id="组件间相互屏蔽隐藏细节-然后选择恰当的通信方式" tabindex="-1"><a class="header-anchor" href="#组件间相互屏蔽隐藏细节-然后选择恰当的通信方式"><span>组件间相互屏蔽隐藏细节，然后选择恰当的通信⽅式</span></a></h3><p>⼦组件需要获取⽗组件的状态，可以通过 <code>props</code> 传递，那么反过来该如何获取呢，如果是根据⼦组件触发的某些事件然后获取，⽗组件可以传⼊⼀个回调函数，⼦组件选择在适当的时机调⽤，并将需要的值作为参数传递给⽗组件。</p><p>除此之外可以考虑 <code>useImperativeHandle</code> 暴露⽅法，如果⽗⼦组件都需要更新该状态(也就是共享)，可以考虑放⼊ <code>Model</code> 中。</p><h2 id="hooks-相关" tabindex="-1"><a class="header-anchor" href="#hooks-相关"><span>Hooks 相关</span></a></h2><h3 id="谨慎使用-usestate-使用-usememo-缓存值" tabindex="-1"><a class="header-anchor" href="#谨慎使用-usestate-使用-usememo-缓存值"><span>谨慎使⽤ useState，使⽤ useMemo 缓存值</span></a></h3><p>谨慎使⽤ useState ，禁⽌新增变量存储 props model 等数据的中间状态，或者其筛选，格式化的结果。涉及到数据中间状态或者格式化的，应该使⽤ useMemo 来缓存，类似 vue 提供的 computed</p><div class="language-jsx line-numbers-mode" data-ext="jsx" data-title="jsx"><pre class="language-jsx"><code><span class="token comment">// 不能直接新增useState来保存，冗余且难以维护</span>
<span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> eleList <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">eleList</span><span class="token operator">:</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>total<span class="token punctuation">,</span> setTotal<span class="token punctuation">]</span> <span class="token operator">=</span> useState<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">(0);
    const [maxEle, setMaxEle] = useState</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">(0);
    ...
    useEffect(() =&gt; </span><span class="token punctuation">{</span>
        <span class="token function">setTotalEle</span><span class="token punctuation">(</span>lodash<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span>eleList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setMaxEle</span><span class="token punctuation">(</span>lodash<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>eleList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token plain-text">, []);
}
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-jsx line-numbers-mode" data-ext="jsx" data-title="jsx"><pre class="language-jsx"><code><span class="token comment">// 使⽤ useMemo 来缓存</span>
<span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> eleList <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">eleList</span><span class="token operator">:</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>total<span class="token punctuation">,</span> max<span class="token punctuation">,</span> mean<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>lodash<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span>eleList<span class="token punctuation">)</span><span class="token punctuation">,</span> lodash<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>eleList<span class="token punctuation">)</span><span class="token punctuation">,</span> lodash<span class="token punctuation">.</span><span class="token function">mean</span><span class="token punctuation">(</span>eleList<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>eleList<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使⽤ hook 需遵守 **&quot;唯⼀数据源&quot;**准则，避免保存中间状态。不保存冗余状态的同时，不保存中间状态，否则会发现更新时需要更新多处，也会⼤⼤增加流程复杂度。</p><p>对于某些状态是单纯依赖更新的，没有事件或副作⽤刷新，你应该使⽤ <code>useMemo</code> ⽽⾮ <code>useState</code> ，⽐如对于列表的筛选，我们唯⼀的数据源就是请求的返回，筛选的结果应该使⽤ <code>useMemo</code> ，⽽不能⽤ <code>useState</code> 保存中间状态。</p><h3 id="使用-ahooks" tabindex="-1"><a class="header-anchor" href="#使用-ahooks"><span>使用 ahooks</span></a></h3><p>当我们需要与浏览器 APi 交互时，也就是副作⽤交汇处，我们⾸先想到的是 <code>ahooks</code> ，如果 <code>ahooks</code> 没有，我们应该⾃定义 hooks 去处理，⽽不应该将副作⽤直接暴露在组件内。</p><p>实际上 <code>ahooks</code> 已经为我们提供了⼏乎所有场景的 hook，最常⻅的是 <code>useRequest</code> <code>useLocalStorageState</code> <code>useDebounce</code> <code>useScroll</code></p><h3 id="使用更加语义化的-useboolean" tabindex="-1"><a class="header-anchor" href="#使用更加语义化的-useboolean"><span>使⽤更加语义化的 useBoolean</span></a></h3><p>当需要维护⼀个 <code>boolean</code> 类型的状态时，推荐使⽤更加语义化的<code>ahooks</code>的 <code>useBoolean</code> ⽽不是通⽤的 <code>useState</code> 。</p><div class="language-jsx line-numbers-mode" data-ext="jsx" data-title="jsx"><pre class="language-jsx"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>visible<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">set</span><span class="token operator">:</span> setVisible <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useBoolean</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="ts-相关" tabindex="-1"><a class="header-anchor" href="#ts-相关"><span>TS 相关</span></a></h2><h3 id="类型的精确是有价值的-类型声明是尽量语义化和缩小范围" tabindex="-1"><a class="header-anchor" href="#类型的精确是有价值的-类型声明是尽量语义化和缩小范围"><span>类型的精确是有价值的，类型声明是尽量语义化和缩⼩范围</span></a></h3><p>能声明为 type KeyType = 0 | 1 的联合类型，就不要声明为 number ;</p><p>能声明为 type DetailType = &#39;SCAN&#39; | &#39;EDIT&#39; | &#39;NEW&#39; 的联合类型，就不要声明为 string ;</p><p>能确定为 number | string | undefined 的联合，就不要声明为 any ;</p><h3 id="避免使用-any" tabindex="-1"><a class="header-anchor" href="#避免使用-any"><span>避免使⽤ any</span></a></h3><p>除了调⽤其他组件或库的交界处，或者是⼀些繁琐的配置属性使⽤ any，其余在代码流程中，请避免使⽤ any，会影响代码的后续维护和 debug。</p><h3 id="大量类型声明单独写在-types-ts" tabindex="-1"><a class="header-anchor" href="#大量类型声明单独写在-types-ts"><span>大量类型声明单独写在 types.ts</span></a></h3><p>⼤量的，多处使⽤到的类型声明，不推荐写在代码流程中，⽽是单独写在 types.ts ⽂件中集中声 明。</p><h3 id="善用-ts-工具类型" tabindex="-1"><a class="header-anchor" href="#善用-ts-工具类型"><span>善⽤ TS ⼯具类型</span></a></h3><p>善⽤ TS ⼯具类型: Pick Record Exclude Omit NonNullable 等，可以灵活实现很多衍⽣类 型</p><h3 id="引入-类型-需要使用-import-type" tabindex="-1"><a class="header-anchor" href="#引入-类型-需要使用-import-type"><span>引⼊&#39;类型&#39;需要使⽤ import type</span></a></h3><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> type <span class="token punctuation">{</span> Moment <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;moment&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="data-onetype-undefined-与-data-onetype" tabindex="-1"><a class="header-anchor" href="#data-onetype-undefined-与-data-onetype"><span>data: OneType | undefined 与 data?: OneType</span></a></h3><p>从语义上来说 <code>data: OneType | undefined</code> 与 <code>data?: OneType</code> 并不相同，前者是参数必须要传，但是数据可以为 undefined；后者是这个参数可以不传，并不影响组件的使⽤。</p><p>如果是⼀般的函数传参，不混产⽣混淆的情况下，可以简单写为后者</p><h3 id="利用-可辨识联合-never-类型-实现分支流程的完整性检查" tabindex="-1"><a class="header-anchor" href="#利用-可辨识联合-never-类型-实现分支流程的完整性检查"><span>利⽤ 可辨识联合 + never 类型，实现分⽀流程的完整性检查</span></a></h3><p>例如下面这段代码，根据业务状态类型，调用不同的请求。在此处类型的&quot;保护与自洽&quot;包括几部分: (这里没有用对象的可辨识属性，而是简单的使用 dataType 这个 number 联合类型，其原理是类似的)</p><ol><li>传参时<code>IDataType</code>限制<code>dataType</code>的范围</li><li>其次，当<code>dataType</code>不正确时，流程会进入最后分支: 将<code>IDataType</code>类型传递给<code>never</code>也会报错</li><li>最后，当<code>dataType</code>不正确时，返回值也会报错<code>Promise&lt;AjaxRes&lt;IPrivatePower[] | IPrivatesSplit[] | IPrivateDaily[]&gt;&gt;</code></li></ol><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> ReqMergedFn <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  dataType<span class="token punctuation">,</span>
  osOrgId<span class="token punctuation">,</span>
  startDate<span class="token punctuation">,</span>
  endDate<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">dataType</span><span class="token operator">:</span> IDataType<span class="token punctuation">,</span>
  <span class="token literal-property property">startDate</span><span class="token operator">:</span> Moment<span class="token punctuation">,</span>
  <span class="token literal-property property">endDate</span><span class="token operator">:</span> Moment<span class="token punctuation">,</span>
  <span class="token literal-property property">osOrgId</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>AjaxRes<span class="token operator">&lt;</span>IPrivatePower<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> IPrivatesSplit<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> IPrivateDaily<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> <span class="token literal-property property">response</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>
    AjaxRes<span class="token operator">&lt;</span>IPrivatePower<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> IPrivatesSplit<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> IPrivateDaily<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span>
  <span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>dataType <span class="token operator">===</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    response <span class="token operator">=</span> <span class="token function">getPrivatePower</span><span class="token punctuation">(</span><span class="token punctuation">{</span> startDate<span class="token punctuation">,</span> endDate<span class="token punctuation">,</span> osOrgId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>dataType <span class="token operator">===</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    response <span class="token operator">=</span> <span class="token function">getPrivateSplit</span><span class="token punctuation">(</span><span class="token punctuation">{</span> startDate<span class="token punctuation">,</span> endDate<span class="token punctuation">,</span> osOrgId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>dataType <span class="token operator">===</span> <span class="token string">&quot;5&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    response <span class="token operator">=</span> <span class="token function">getPrivateDaily</span><span class="token punctuation">(</span><span class="token punctuation">{</span> startDate<span class="token punctuation">,</span> endDate<span class="token punctuation">,</span> osOrgId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">/* 当进入此分支时，类型与never不兼容而报错 */</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">dt</span><span class="token operator">:</span> never</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Unexpected Value of dataType: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>dt<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">/* 抛出错误后，返回值的类型为never，与既定的return类型不符合 */</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dataType<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> response<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ecma-函数相关" tabindex="-1"><a class="header-anchor" href="#ecma-函数相关"><span>ECMA,函数相关</span></a></h2><h3 id="使用-和-安全取值" tabindex="-1"><a class="header-anchor" href="#使用-和-安全取值"><span>使用.?和??安全取值</span></a></h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Optional_chaining" target="_blank" rel="noopener noreferrer">可选链操作符(Optional_chaining)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 与 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator" target="_blank" rel="noopener noreferrer">空值合并运算符(Null 判断运算符)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，我们在对对象和数组取值，在对函数执行时，<strong>可能因为其值不存在而造成报错</strong>，使用以上两种方式再配合上判空，能大大提高我们取值操作的安全性。</p><p>仅 <code>undefined</code> 才会触发解构和函数传参的默认值；⽽ <code>undefined</code>, <code>null</code> 能触发可选链和 Null 判断运算符</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 组合使⽤</span>
<span class="token comment">// 当值为: null 或 undefined时, ?? 才有效</span>
<span class="token keyword">const</span> detailPrice <span class="token operator">=</span> orgItem<span class="token operator">?.</span>detail<span class="token operator">?.</span>price <span class="token operator">??</span> <span class="token number">33</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> price <span class="token operator">=</span> orgItem <span class="token operator">??</span> <span class="token punctuation">{</span> <span class="token literal-property property">price</span><span class="token operator">:</span> <span class="token number">123</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//尤其是动态的键</span>
<span class="token keyword">const</span> val <span class="token operator">=</span> obj<span class="token operator">?.</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 数组类似</span>
<span class="token keyword">const</span> price <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">?.</span>summary<span class="token operator">?.</span>price <span class="token operator">??</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token comment">// 函数: 当不存在时，不执⾏</span>
fn<span class="token operator">?.</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
fn<span class="token operator">?.</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">??</span> fn2<span class="token operator">?.</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">NaN</span> <span class="token operator">===</span> <span class="token number">NaN</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
<span class="token operator">-</span><span class="token number">0</span> <span class="token operator">===</span> <span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
Object<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">,</span> <span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
Object<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="谨慎对待循环-尤其是嵌套的循环" tabindex="-1"><a class="header-anchor" href="#谨慎对待循环-尤其是嵌套的循环"><span>谨慎对待循环，尤其是嵌套的循环</span></a></h3><p>遍历⼀般采⽤回调式的⾼阶函数，例如 <code>map forEach filter find findIndex some every reducer</code> ，使⽤ es6 的 <code>for...of</code> 灵活中断循环</p><p>此外 lodash 提供了许多便利的遍历⽅法，⽐如 <code>sumBy sortBy groupBy flatten</code></p><p>在⼀个作⽤域内，相同的数组尽量只遍历⼀次(除⾮是从代码语义⻆度应该分别循环处理的)，同时完成筛选、匹配、判断等，降低循环对性能的影响，循环的结果也可以使⽤ <code>useMemo</code> 缓存下来，防⽌每次都执⾏循环</p><h3 id="善用结构" tabindex="-1"><a class="header-anchor" href="#善用结构"><span>善用结构</span></a></h3><p>在对象只需要⽤到其属性，⽽不需要对象本身时，可以直接解构，忽略掉对象变量</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>div key<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> id<span class="token punctuation">,</span> name <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>div key<span class="token operator">=</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>类似的 import 也推荐按需引⼊</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> mean<span class="token punctuation">,</span> cloneDeep<span class="token punctuation">,</span> isEmpty <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;lodash&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>数组也推荐直接使⽤解构赋值</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>columns<span class="token punctuation">,</span> formObj<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">mergeColumnsAndFormData</span><span class="token punctuation">(</span><span class="token function">getColumns</span><span class="token punctuation">(</span>mltTradeCycle<span class="token punctuation">)</span><span class="token punctuation">,</span> dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>dataSource<span class="token punctuation">,</span> mltTradeCycle<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="不要构造成-undefined-的结构" tabindex="-1"><a class="header-anchor" href="#不要构造成-undefined-的结构"><span>不要构造成 [&#39;&#39;] [undefined] 的结构</span></a></h3><p>很难判断数据的合法性</p><div class="language-jsx line-numbers-mode" data-ext="jsx" data-title="jsx"><pre class="language-jsx"><code><span class="token comment">// 初始化</span>
<span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token punctuation">{</span>
<span class="token literal-property property">unitId</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">// 使⽤时</span>
<span class="token operator">&lt;</span>Child value <span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>unitId<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
<span class="token comment">// 组件内，判空失误</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&amp;&amp;</span> value<span class="token operator">?.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="使用-占位无用参数" tabindex="-1"><a class="header-anchor" href="#使用-占位无用参数"><span>使用“_”占位无用参数</span></a></h3><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">[</span>_<span class="token punctuation">,</span> price<span class="token punctuation">,</span> powerData<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> params<span class="token operator">?.</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="过滤对象中的属性" tabindex="-1"><a class="header-anchor" href="#过滤对象中的属性"><span>过滤对象中的属性</span></a></h3><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 需要过滤掉value和price</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;⼴东⽕电&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span> <span class="token literal-property property">price</span><span class="token operator">:</span> <span class="token number">888</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// ⽅案1结构，简单快捷，但是eslint会报警告</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> value<span class="token punctuation">,</span> price <span class="token punctuation">,</span><span class="token operator">...</span>rest <span class="token punctuation">}</span> <span class="token operator">=</span> obj<span class="token punctuation">;</span>
<span class="token comment">// ⽅案2使⽤omit(类似的还有pick)</span>
<span class="token keyword">const</span> target <span class="token operator">=</span> lodash<span class="token punctuation">.</span><span class="token function">omit</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;value&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="善用lodash库" tabindex="-1"><a class="header-anchor" href="#善用lodash库"><span>善用<a href="https://www.lodashjs.com/" target="_blank" rel="noopener noreferrer">lodash<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>库</span></a></h3><p><strong>不要重复手写各种复杂的判断或循环</strong>，涉及到断言或转换(isNumber, isEmpty, toNumber, toArray)，遍历条件查找，排序、分组、交集、去重、复制、数据格式化等，优先想到<code>lodash</code>。</p><h3 id="统一函数的-return-行为" tabindex="-1"><a class="header-anchor" href="#统一函数的-return-行为"><span>统⼀函数的 return ⾏为</span></a></h3><p>当需要返回数据时，请确认每个分⽀都返回，并且数据类型相同。不允许部分返回字符串，部分返回数字的情况。</p><h3 id="函数式编程" tabindex="-1"><a class="header-anchor" href="#函数式编程"><span>函数式编程</span></a></h3><p>&quot;函数式编程&quot;是一种&quot;编程范式&quot;（programming paradigm），也就是如何编写程序的方法论。它属于&quot;结构化编程&quot;的一种，主要思想是把运算过程尽量写成一系列嵌套的函数调用。</p><p>函数式编程的核⼼之⼀就是 <strong>纯函数 与 数据不可变</strong></p><p>对参数中引⽤类型的修改，⽐如对数组和对象的合并，需要保证不影响源数据，简单的数组、对象合并可以使⽤展开符。复杂对象可以使⽤ lodash.cloneDeep 进⾏深复制。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 不推荐，直接修改了原对象</span>
<span class="token keyword">const</span> newObj <span class="token operator">=</span> obj<span class="token punctuation">;</span>
newObj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;new name&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 改为</span>
<span class="token keyword">const</span> newObj <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>obj<span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;new name&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 复杂对象可以使⽤cloneDeep复制后操作</span>
<span class="token keyword">const</span> shadowObj <span class="token operator">=</span> lodash<span class="token punctuation">.</span><span class="token function">cloneDeep</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="纯函数" tabindex="-1"><a class="header-anchor" href="#纯函数"><span>纯函数</span></a></h4><p>纯函数是函数式编程的基石，无副作用的函数</p><ul><li>函数在相同的输入值时，总是产生相同的输出。函数的输出和当前运行环境的上下文状态无关。</li><li>函数运行过程不影响运行环境，也就是无副作用（如触发事件、发起 http 请求、打印/log 等）</li></ul><p>简单来说，也就是<strong>当一个函数的输出不受外部环境影响，同时也不影响外部环境时，该函数就是纯函数</strong></p><p>纯函数在可缓存性、可移植性、可测试性以及并行计算方面都有着巨大的优势：</p><ul><li>可以进行缓存。我们就可以采用动态规划的方法保存中间值，用来代替实际函数的执行结果，大大提升效率。</li><li>可以进行高并发。因为不依赖于环境，可以调度到另一个线程、worker 甚至其它机器上，反正也没有环境依赖。</li><li>容易测试，容易证明正确性。不容易产生偶现问题，也跟环境无关，非常利于测试。</li></ul><h4 id="特点" tabindex="-1"><a class="header-anchor" href="#特点"><span>特点</span></a></h4><ul><li><p>函数是&quot;第一等公民&quot;</p><p>函数与其他数据类型一样，处于平等地位，可以赋值给其他变量，也可以作为参数，传入另一个函数，或者作为别的函数的返回值。</p></li><li><p>只用&quot;表达式&quot;，不用&quot;语句&quot;</p><p>&quot;表达式&quot;（expression）是一个单纯的运算过程，总是有返回值；&quot;语句&quot;（statement）是执行某种操作，没有返回值。函数式编程要求，只使用表达式，不使用语句。也就是说，每一步都是单纯的运算，而且都有返回值。</p></li><li><p>没有&quot;副作用&quot;</p><p>所谓&quot;副作用&quot;（side effect），指的是函数内部与外部互动（最典型的情况，就是修改全局变量的值），函数式编程所有功能就是返回一个新的值，没有其他行为，尤其是不得修改外部变量的值。</p></li><li><p>不修改状态</p><p>变量往往用来保存&quot;状态&quot;（state），不修改状态意味着状态不能保存在变量中。函数式编程使用参数保存状态，最好的例子就是递归。</p></li><li><p>引用透明</p><p>引用透明（Referential transparency），指的是函数的运行不依赖于外部变量或&quot;状态&quot;，只依赖于输入的参数，<strong>任何时候只要参数相同，引用函数所得到的返回值总是相同的。</strong></p><p>函数的返回值与系统状态有关时，不同的状态之下，返回值是不一样的。这就叫&quot;引用不透明&quot;，很不利于观察和理解程序的行为</p></li></ul><h4 id="为什么不可变性在-react-中非常重要" tabindex="-1"><a class="header-anchor" href="#为什么不可变性在-react-中非常重要"><span><a href="https://zh-hans.reactjs.org/tutorial/tutorial.html#why-immutability-is-important" target="_blank" rel="noopener noreferrer">为什么不可变性在 React 中非常重要<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></span></a></h4><p>不可变性有以下几点好处</p><ul><li><p>简化复杂的功能</p><p>不可变性使得复杂的特性更容易实现，撤销和恢复功能在开发中是一个很常见的需求，不直接在数据上修改可以让我们追溯并复用历史记录。</p></li><li><p>跟踪数据的改变</p><p>可变对象跟踪数据的改变需要整个对象树被遍历一次，跟踪不可变数据的变化相对来说就容易多了。如果发现对象变成了一个新对象，那么我们就可以说对象发生改变了。</p></li><li><p>确定在 React 中何时重新渲染</p><p>不可变性最主要的优势在于它可以帮助我们在 React 中创建 <code>pure components</code>。我们可以很轻松的确定不可变数据是否发生了改变，从而确定何时对组件进行重新渲染。</p></li></ul><h3 id="错误边界" tabindex="-1"><a class="header-anchor" href="#错误边界"><span>错误边界</span></a></h3><h4 id="来由" tabindex="-1"><a class="header-anchor" href="#来由"><span>来由</span></a></h4><p>过去，组件内的 JavaScript 错误会导致 React 的内部状态被破坏，并且在下一次渲染时 产生 可能无法追踪的 错误，React 并没有提供一种在组件中优雅处理这些错误的方式，也无法从错误中恢复。</p><p>部分 UI 的 JavaScript 错误不应该导致整个应用崩溃，为了解决这个问题，React 16 引入了一个新的概念 —— <strong>错误边界</strong>。</p><h4 id="概念" tabindex="-1"><a class="header-anchor" href="#概念"><span>概念</span></a></h4><p>错误边界是一种 React 组件，这种组件可以捕获发生在整个子组件树的渲染期间、生命周期方法以及构造函数中任何位置的 JavaScript 错误，并打印这些错误，同时展示降级 UI</p><p>错误边界的工作方式类似于 JavaScript 的 catch {}，不同的地方在于错误边界只针对 React 组件。<strong>只有 class 组件才可以成为错误边界组件。</strong></p><p>大多数情况下, 你只需要声明一次错误边界组件, 并在整个应用中使用它。</p><blockquote><p>错误边界无法捕获以下场景中产生的错误：</p><ul><li>事件处理</li><li>异步代码（例如 setTimeout 或 requestAnimationFrame 回调函数）</li><li>服务端渲染</li><li>它自身抛出来的错误（并非它的子组件）</li></ul></blockquote><p>如果一个 class 组件中定义了 <code>static getDerivedStateFromError()</code> 或 <code>componentDidCatch()</code> 这两个生命周期方法中的任意一个（或两个）时，那么它就变成一个错误边界。</p><p>当抛出错误后，请使用 <code>static getDerivedStateFromError()</code> 渲染备用 UI ，使用 <code>componentDidCatch()</code> 打印错误信息。</p><div class="language-jsx line-numbers-mode" data-ext="jsx" data-title="jsx"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">ErrorBoundary</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">hasError</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromError</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 更新 state 使下一次渲染能够显示降级后的 UI</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">hasError</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentDidCatch</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> errorInfo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 你同样可以将错误日志上报给服务器</span>
    <span class="token function">logErrorToMyService</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> errorInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>hasError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 你可以自定义降级后的 UI 并渲染</span>
      <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Something went wrong.</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="未捕获错误-uncaught-errors-的新行为" tabindex="-1"><a class="header-anchor" href="#未捕获错误-uncaught-errors-的新行为"><span>未捕获错误（Uncaught Errors）的新行为</span></a></h4><p><strong>自 React 16 起，任何未被错误边界捕获的错误将会导致整个 React 组件树被卸载。</strong></p><p>增加错误边界能够让你在应用发生异常时提供更好的用户体验。</p><p>函数组件中在⼀些可能报错的情况(如 JSON 解析、DOM 操作与浏览器 API、<code>async/await</code> 等)，可以考虑使⽤ <code>try...catch...finally </code>捕获，尽量减少报错的影响，避免错误扩散，导致整个 UI ⻚⾯ 崩溃。</p><h2 id="service-相关" tabindex="-1"><a class="header-anchor" href="#service-相关"><span>Service 相关</span></a></h2><h3 id="关于请求相关的内容需单独写在-services-ts-文件-便于维护" tabindex="-1"><a class="header-anchor" href="#关于请求相关的内容需单独写在-services-ts-文件-便于维护"><span>关于请求相关的内容需单独写在 services.ts ⽂件，便于维护</span></a></h3><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// services.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> request <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;umi&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 登录接口</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> accountLogin <span class="token operator">=</span> <span class="token punctuation">(</span>params<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">username</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  <span class="token literal-property property">password</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> PromiseRes<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/login</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    params<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="请求参数格式化或处理" tabindex="-1"><a class="header-anchor" href="#请求参数格式化或处理"><span>请求参数格式化或处理</span></a></h3><p>⽐如数组的 toString , ⽇期的格式化 format 等，不要再调⽤处处理(除⾮是逻辑紧耦合的判断等)，统⼀在 service ⾥⾯格式化，外⾯不关⼼处理细节，否则每次调⽤都单独处理，冗余且容易造成格式化两次的错误。</p><h3 id="请求时判断参数避免重复请求" tabindex="-1"><a class="header-anchor" href="#请求时判断参数避免重复请求"><span>请求时判断参数避免重复请求</span></a></h3><p>应避免重复请求的现象，明确触发请求的依赖状态，例如当请求参数为空时，应该阻⽌本次请求。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>runDates <span class="token operator">||</span> <span class="token operator">!</span>orgId<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token function">runMonth</span><span class="token punctuation">(</span><span class="token punctuation">{</span> runDates<span class="token punctuation">,</span> orgId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>runMonth<span class="token punctuation">,</span> runDates<span class="token punctuation">,</span> orgId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>runDates</code> 和 <code>orgId</code> 被赋值期间 <code>useEffect</code> 可能被触发多次，当都值时再请求</p><h3 id="完善-service-文件里请求方法参数类型和返回值类型" tabindex="-1"><a class="header-anchor" href="#完善-service-文件里请求方法参数类型和返回值类型"><span>完善 Service 文件里请求方法参数类型和返回值类型</span></a></h3><p>请求返回的数据是模块的最重要的数据源，请在 service 完善参数类型和返回值类型，并写明注释。后端的字段很可能有冗余，我们只需要写使⽤到的字段</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> getCaseList <span class="token operator">=</span> <span class="token punctuation">(</span>params<span class="token operator">:</span> <span class="token punctuation">{</span>
  caseName<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token comment">// 注释</span>
  <span class="token literal-property property">runDate</span><span class="token operator">:</span> Moment<span class="token punctuation">,</span> <span class="token comment">// 注释</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> PromiseRes<span class="token operator">&lt;</span>ICaseItem<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">API_PREFIX</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/api/case/list</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// 参数处理统一都放在service内部 (除了与逻辑强耦合的情况)</span>
    <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>params<span class="token punctuation">,</span>
      <span class="token literal-property property">runDate</span><span class="token operator">:</span> params<span class="token operator">?.</span>runDate<span class="token operator">?.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;YYYY-MM&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ahooks-userequest" tabindex="-1"><a class="header-anchor" href="#ahooks-userequest"><span>ahooks.useRequest</span></a></h3><p>调⽤请求，统⼀使⽤ <code>ahooks.useRequest</code> ，这个是 ahooks ⾥最重要的 hook</p><h4 id="manual" tabindex="-1"><a class="header-anchor" href="#manual"><span>manual</span></a></h4><p>灵活使⽤ <code>useRequest</code> 的⾃动请求 <code>manual</code> 属性，如果设置了 <code>options.manual = true</code>，则 <code>useRequest</code> 不会默认执行，需要通过 <code>run</code> 来触发执行。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> loading<span class="token punctuation">,</span> run <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>changeUsername<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">manual</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 下⾯这种⾮常冗余，还会造成重复请求</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> run <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequset</span><span class="token punctuation">(</span>getUnitList<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">manual</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="轮询请求需要完善-onerror-回调函数" tabindex="-1"><a class="header-anchor" href="#轮询请求需要完善-onerror-回调函数"><span>轮询请求需要完善 onError 回调函数</span></a></h4><p>请求涉及到轮询的，需要完善 onError 回调函数，并在⾥⾯ cancel 掉轮询，防⽌后端返回错误后继续请求</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> loading<span class="token punctuation">,</span> run<span class="token punctuation">,</span> cancel <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>getUsername<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">manual</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onError</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">pollingInterval</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
  <span class="token literal-property property">pollingWhenHidden</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="mutate-方法" tabindex="-1"><a class="header-anchor" href="#mutate-方法"><span>mutate ⽅法</span></a></h4><p><code>useRequest</code> 会返回 <code>mutate</code> ⽅法，允许我们变更返回的数据，可以⽤在更新数据提交保存时，提前修改请求数据，或者在调试请求数据时修改为测试数据。</p><h4 id="使用-async-await-处理数据源" tabindex="-1"><a class="header-anchor" href="#使用-async-await-处理数据源"><span>使用 async/await 处理数据源</span></a></h4><p>在 <code>ahooks@3</code> 的 <code>useRequest</code> 移除了 <code>formatResult</code> 属性，请不要再使⽤，如果确定需要在数据源处统⼀格式化处理，可以改为最新的 <code>async/await</code> 写法</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">run</span><span class="token operator">:</span> runList<span class="token punctuation">,</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> caseList<span class="token punctuation">,</span>
  loading<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>
  <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">params</span><span class="token operator">:</span> Parameters<span class="token operator">&lt;</span><span class="token keyword">typeof</span> getCaseList<span class="token operator">&gt;</span><span class="token punctuation">[</span>number<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getCaseList</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      item<span class="token punctuation">.</span>sumPower <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>powerList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">manual</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function-variable function">onSuccess</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      message<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">&quot;请求成功!&quot;</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="onsuccess-不处理相应数据" tabindex="-1"><a class="header-anchor" href="#onsuccess-不处理相应数据"><span>onSuccess 不处理相应数据</span></a></h4><p><code>onSuccess</code> ⾥⾯不是⽤来处理相应数据的，⾥⾯的 <code>response</code> 是只读的，</p><p><code>onSuccess</code> 是⽤于触发⼀些事件回调或提示流程，或者根据返回的内容处理其他数据的。(除⾮⼀种情况，请求的数据在⻚⾯上是可修改的，需要在 <code>onSuccess</code> 存⼊ <code>model</code> 前做处理)</p><h2 id="model-相关" tabindex="-1"><a class="header-anchor" href="#model-相关"><span>Model 相关</span></a></h2><h3 id="独立的-model-ts" tabindex="-1"><a class="header-anchor" href="#独立的-model-ts"><span>独立的 model.ts</span></a></h3><p>model 相关的内容，请单独写在 model.ts ⽂件，便于维护。</p><p>并确保其类型声明和必要的注释，便于其他⼈使⽤</p><p><img src="/my-notes/assets/6-CYaFY5pL.png" alt=""></p><h3 id="使用createevamodel" tabindex="-1"><a class="header-anchor" href="#使用createevamodel"><span>使用<code>createEvaModel</code></span></a></h3><p>新项目使用<code>createEvaModel</code>，请注意查看，新版文档 👉<a href="http://frontend.pages.tsintergy.com:8070/eva/" target="_blank" rel="noopener noreferrer">eva model<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><h3 id="reducers-和-effects" tabindex="-1"><a class="header-anchor" href="#reducers-和-effects"><span>reducers 和 effects</span></a></h3><p>当需要封装⼀系列复杂的操作时，可以声明 reducers 和 effects 。</p><h3 id="保证状态最小化" tabindex="-1"><a class="header-anchor" href="#保证状态最小化"><span>保证状态最⼩化</span></a></h3><p>在保证 State 完整的同时，也要保证其最⼩化&quot;,不要滥⽤ State ，许多复杂场景的复杂度来源就是: 数据流不清晰, 定义了冗余的 State 。</p><p>只有那些有必要的状态才存⼊ model，⽐如跨组件共享的状态，多处修改的状态</p><h3 id="确保更新的数据已初始化" tabindex="-1"><a class="header-anchor" href="#确保更新的数据已初始化"><span>确保更新的数据已初始化</span></a></h3><p><code>model.actions.update</code>更新的数据一定是初始化时声明的变量，往里面添加新状态也能成功，但是维护起来非常迷惑。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// total是没有在state声明的</span>
Model<span class="token punctuation">.</span>actions<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;集团侧&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">total</span><span class="token operator">:</span> <span class="token number">1234</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="其余代码优化" tabindex="-1"><a class="header-anchor" href="#其余代码优化"><span>其余代码优化</span></a></h2><h3 id="抽离配置代码" tabindex="-1"><a class="header-anchor" href="#抽离配置代码"><span>抽离配置代码</span></a></h3><p>与&quot;响应式的状态, hooks&quot;⽆关的许多配置代码，推荐单独抽离放在 <code>config.ts</code> 或 <code>config.tsx</code> 中，保持主逻辑流程的简洁清晰。如配置列表，Table 的表头配置， Echarts 的配置等。</p><p>注意: 实际情况很多都是动态配置，所以 <strong>⼀般都是写成调⽤函数，通过参数动态控制</strong>。</p><p><img src="/my-notes/assets/32-TUoXPIEF.png" alt=""><img src="/my-notes/assets/34-CHBlSlO5.png" alt=""><img src="/my-notes/assets/33-D5MjnlC2.png" alt=""></p><h3 id="moment" tabindex="-1"><a class="header-anchor" href="#moment"><span><a href="http://momentjs.cn/" target="_blank" rel="noopener noreferrer">moment<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></span></a></h3><h4 id="保持-moment-实例" tabindex="-1"><a class="header-anchor" href="#保持-moment-实例"><span>保持 moment 实例</span></a></h4><p>荐在整个代码逻辑或数据流中保持 <code>moment</code> 实例对象，⽐如在 <code>model</code> 中存储 <code>moment</code> 实例对象，⽽⾮⽇期字符串，便于统⼀操作，有需要时才获取其格式化字符串。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">runDate</span><span class="token operator">:</span> <span class="token string">&#39;2022-02-22&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 不推荐</span>
    <span class="token literal-property property">runDate</span><span class="token operator">:</span> <span class="token function">moment</span><span class="token punctuation">(</span><span class="token string">&#39;2022-02-22&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 推荐</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="使用更加语义化的方法" tabindex="-1"><a class="header-anchor" href="#使用更加语义化的方法"><span>使⽤更加语义化的⽅法</span></a></h4><p>moment 相关的操作，推荐使⽤更加语义化的⽅法</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 复制⽇期</span>
<span class="token function">moment</span><span class="token punctuation">(</span>runDate<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;YYYY-MM-DD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 改为</span>
runDate<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ⽐较⽇期</span>
startDate <span class="token operator">&lt;=</span> endDate<span class="token punctuation">;</span>
<span class="token comment">// 改为</span>
startDate<span class="token punctuation">.</span><span class="token function">isSameOrBefore</span><span class="token punctuation">(</span>endDate<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 判断范围</span>
startDate <span class="token operator">&lt;</span> runDate <span class="token operator">&amp;&amp;</span> endDate <span class="token operator">&gt;</span> runDate<span class="token punctuation">;</span>
<span class="token comment">// 改为</span>
runDate<span class="token punctuation">.</span><span class="token function">isBetween</span><span class="token punctuation">(</span>startDate<span class="token punctuation">,</span> endDate<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="命名" tabindex="-1"><a class="header-anchor" href="#命名"><span>命名</span></a></h3><ul><li><p>⽂件命名，函数命名，变量命名等推荐使⽤现有的或习惯的命名，类型的业务场景或者上下⽂使⽤相同的命名或单词。⽐如运⾏⽇⼀般⽤ <code>runDate</code> ，运⾏⽇范围⼀般⽤ <code>runDates</code> ，就不要新增 <code>date</code>, <code>dateRange</code>, <code>caseDates</code>, <code>currentDate</code> 等。</p></li><li><p>复杂的业务⻚⾯不推荐使⽤通⽤的命名，最好与业务绑定，便于 <code>ctrl + f</code> 查找或替换; 并且⽗⼦函数中不要出现相同的变量，容易使⽤错</p></li></ul><h3 id="字符串硬编码定义为配置" tabindex="-1"><a class="header-anchor" href="#字符串硬编码定义为配置"><span>字符串硬编码定义为配置</span></a></h3><p>减少魔术数字、魔术字符串、字符串硬编码。多次出现的字⾯量，可以考虑定义为 config ⾥的配置项，或者是配置数组，枚举变量等，也便于声明联合类型</p><p>配置数组请使⽤ <code>{ id: xxx, name: xxx }</code>的格式</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// ⼀次定义，处处引⽤，请注意 &#39;as const&#39;断⾔⽤法</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> menuList <span class="token operator">=</span> <span class="token punctuation">[</span>
<span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;overview&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;持仓总览&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;summary&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;指标汇总&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> menuList<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>
<span class="token comment">// 获取id的联合类型</span>
type IdType <span class="token operator">=</span> <span class="token keyword">typeof</span> menuList<span class="token punctuation">[</span>number<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="使用-map-数据结构优化数组查找" tabindex="-1"><a class="header-anchor" href="#使用-map-数据结构优化数组查找"><span>使⽤ Map 数据结构优化数组查找</span></a></h3><p>对于配置数组的查找，灵活使⽤ Map 数据结构，把多次需要 find some 查找遍历的操作，从 O(n) 优化为 O(1) 。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> unitList <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;e4f3431c7e767a41017e9442988401b7&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;⼴东⽕电&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;e4eefea57de69698017e0097c97d03ac&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;⼭⻄客户5&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;e4eefea57de69698017dea0873fd0031&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;⼭⻄机组#2&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;8280818779cb82450179cb8422a30000&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;⼭⻄&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// ⽣成以id为键的Map结构</span>
<span class="token keyword">const</span> <span class="token literal-property property">unitMap</span><span class="token operator">:</span> Map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> Record<span class="token operator">&lt;</span>id <span class="token operator">|</span> name<span class="token punctuation">,</span> string<span class="token operator">&gt;&gt;</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span>
  unitList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>item<span class="token punctuation">.</span>id<span class="token punctuation">,</span> item<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 根据id获取电⼚名，不⽤每次都⽤find遍历</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> unitMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>unitID<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="定义断言函数" tabindex="-1"><a class="header-anchor" href="#定义断言函数"><span>定义断⾔函数</span></a></h3><p>⽐较复杂的判断，可以考虑不夹杂在主流程代码中，单独抽出⼀个断⾔函数， <code>(conditions) =&gt; boolean</code> ，增加代码的可读性可维护性。</p><p>使⽤ <code>includes</code> 简化多个值⽐较相等或不相等</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 判断相等</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;a&#39;</span> <span class="token operator">||</span> type <span class="token operator">===</span> <span class="token string">&#39;b&#39;</span> <span class="token operator">||</span> type <span class="token operator">===</span> <span class="token string">&#39;c&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// 改为</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;b&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// 判断不相等</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;a&#39;</span> <span class="token operator">||</span> type <span class="token operator">===</span> <span class="token string">&#39;b&#39;</span> <span class="token operator">||</span> type <span class="token operator">===</span> <span class="token string">&#39;c&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">!==</span> <span class="token string">&#39;a&#39;</span> <span class="token operator">&amp;&amp;</span> type <span class="token operator">!==</span> <span class="token string">&#39;b&#39;</span> <span class="token operator">&amp;&amp;</span> type <span class="token operator">!==</span> <span class="token string">&#39;c&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// 改为</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;b&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="提前-return-减少嵌套层级" tabindex="-1"><a class="header-anchor" href="#提前-return-减少嵌套层级"><span>提前 return 减少嵌套层级</span></a></h3><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> meanPrice <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>sumEle<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="巧用柯里化函数" tabindex="-1"><a class="header-anchor" href="#巧用柯里化函数"><span>巧⽤柯⾥化函数</span></a></h3><p>巧⽤柯⾥化函数: 拆分传参或缓存部分内容</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 同时处理四份数据, 缓存公共的内容</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> totalIncome<span class="token punctuation">,</span> netIncome<span class="token punctuation">,</span> onlineEle<span class="token punctuation">,</span> mltEle <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token comment">// 第⼀次调⽤，处理公共的循环</span>
<span class="token keyword">const</span> middleFn <span class="token operator">=</span> <span class="token function">getDataWithTicks</span><span class="token punctuation">(</span>monthList<span class="token punctuation">,</span> runDates<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 第⼆次调⽤，处理个性内容</span>
<span class="token keyword">return</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">totalIncome</span><span class="token operator">:</span> <span class="token function">middleFn</span><span class="token punctuation">(</span><span class="token string">&#39;totalIncome&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">netIncome</span><span class="token operator">:</span> <span class="token function">middleFn</span><span class="token punctuation">(</span><span class="token string">&#39;netIncome&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">onlineEle</span><span class="token operator">:</span> <span class="token function">middleFn</span><span class="token punctuation">(</span><span class="token string">&#39;onlineEle&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mltEle</span><span class="token operator">:</span> <span class="token function">middleFn</span><span class="token punctuation">(</span><span class="token string">&#39;mltEle&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">as</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>monthList<span class="token punctuation">,</span> runDates<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="antd-使用相关" tabindex="-1"><a class="header-anchor" href="#antd-使用相关"><span>Antd 使⽤相关</span></a></h2><h3 id="使用非受控组件" tabindex="-1"><a class="header-anchor" href="#使用非受控组件"><span>使⽤⾮受控组件</span></a></h3><p>除了⾃定义组件时，⼤多数时候推荐使⽤⾮受控组件，让组件⾃⾏运⾏，我们<strong>只关⼼最初的初始化数据，以及触发事件等改变的回调函数和返回的最新值</strong>。最典型的就是 <code>Table</code> 和 <code>Form</code> 组件，及其表单输⼊控件 <code>Input</code> <code>DatePicker</code> <code>Checkbox</code> 等。</p><h3 id="该使用-form-统一操作" tabindex="-1"><a class="header-anchor" href="#该使用-form-统一操作"><span>该使⽤ Form 统⼀操作</span></a></h3><h4 id="单个控件" tabindex="-1"><a class="header-anchor" href="#单个控件"><span>单个控件</span></a></h4><p>表单输⼊控件除了确定是唯⼀⼀个时，可以直接操作控件。此外都应该使⽤ Form 来统⼀操作。</p><p><img src="/my-notes/assets/13-Db0E2U-x.png" alt=""></p><h4 id="多个控件" tabindex="-1"><a class="header-anchor" href="#多个控件"><span>多个控件</span></a></h4><p><code>Form.useForm()</code>可创建 form 控制实例，可以⽤于获取或设置表单数据。</p><ul><li><code>getFieldValue</code> ⽤于获取当前表单的数据；</li><li><code>setFieldsValue</code> <code>setFields</code> ⽤于设置更新数据，也⽤于初始化回显数据；</li><li><code>resetFields</code>用于重置；</li><li><code>submit</code>用于提交</li></ul><p>多个控件应该由 Form 统⼀接管数据初始化( <code>form.setFieldsValue</code> )，回调事件 (<code>onValuesChange</code> <code>onFinish</code>)，⽽不应该直接操作输⼊控件，冗余且不便维护。</p><p>在使⽤ FormInstance 后，表单的初始化可以动态进⾏，⼀般不再使⽤ <code>Form.initialValues</code> 以及 <code>Form.Item.initialValue</code> 的静态初始化</p><p><img src="/my-notes/assets/24-DToolDXX.png" alt=""><img src="/my-notes/assets/25-DRxuwjpZ.png" alt=""><img src="/my-notes/assets/26-BR_Qkfd8.png" alt=""></p><h4 id="表单响应" tabindex="-1"><a class="header-anchor" href="#表单响应"><span>表单响应</span></a></h4><p>Form 的两种⽤法: 实时响应与提交响应。</p><p>第⼀种，当我们修改某⼀个输⼊控件时，⽴即做出相应，⽐如直接请求新数据，这种应该使⽤ <code>onValuesChange</code> 回调函数；</p><p>第⼆种，我们可以修改多个输⼊控件，当⽐如点击提交按钮 <code>&lt;Button htmlType=&#39;submit&#39;&gt;</code>提交<code>&lt;/Button&gt;</code> 时，才发出请求，这种&quot;带缓存的状态&quot;，使⽤ <code>onFinish</code> 。</p><p><img src="/my-notes/assets/27-IeKqEK6F.png" alt=""><img src="/my-notes/assets/28-DgJlWbNE.png" alt=""></p><h3 id="模态窗-modal-自己维护状态" tabindex="-1"><a class="header-anchor" href="#模态窗-modal-自己维护状态"><span>模态窗 Modal 自己维护状态</span></a></h3><p>模态窗 Modal 控制开关的状态不是调⽤的⽗组件维护的，⽽是⼦组件⾃⼰维护并通过 <code>useImperativeHandle</code> 暴露⼀个开关⽅法，这样的好处是数据状态更加清晰，并其复⽤同⼀个模态窗更⽅便；</p><p>缺点是写法麻烦，并且 <code>Modal</code> 组件在⽗组件初始化时就渲染执⾏了 <code>useMount</code> 并发出请求，⽽不是打开模态窗才开始渲染(可以考虑在⼦组件内再套⼀层判断)</p><div class="language-jsx line-numbers-mode" data-ext="jsx" data-title="jsx"><pre class="language-jsx"><code><span class="token keyword">const</span> <span class="token literal-property property">Index</span><span class="token operator">:</span> <span class="token constant">FC</span><span class="token operator">&lt;</span><span class="token punctuation">{</span>
  <span class="token literal-property property">mRef</span><span class="token operator">:</span> MutableRefObject<span class="token operator">&lt;</span><span class="token punctuation">{</span> <span class="token function-variable function">showModal</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">flag</span><span class="token operator">:</span> boolean</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span> <span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> mRef <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>visible<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">set</span><span class="token operator">:</span> setVisible <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useBoolean</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">/* 对外暴露接口 */</span>
  <span class="token function">useImperativeHandle</span><span class="token punctuation">(</span>mRef<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">showModal</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">flag</span><span class="token operator">:</span> boolean <span class="token operator">=</span> <span class="token boolean">true</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setVisible</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>visible <span class="token operator">&amp;&amp;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">RealModal</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="disabled-和-loading" tabindex="-1"><a class="header-anchor" href="#disabled-和-loading"><span>disabled 和 loading</span></a></h3><p>Button 或输⼊表单控件，应关注其 disabled 和 loading 属性，尤其是 Button，防⽌重复点击重复请求。</p><h3 id="select-使用-options-配置子项" tabindex="-1"><a class="header-anchor" href="#select-使用-options-配置子项"><span>Select 使⽤ options 配置⼦项</span></a></h3><p>Select 使⽤推荐 options 来配置⼦项，⽽不是遍历<code> &lt;Select.Option&gt;</code> ，这样更好维护。</p><p><img src="/my-notes/assets/19-BIRF_PUD.png" alt=""></p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: guokc@tsintergy.com">guokc</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav" aria-label="page navigation"><p class="inner"><span class="prev"><a class="route-link" href="/my-notes/react/umijs.html" aria-label="umijs"><!--[--><!--]--> umijs <!--[--><!--]--></a></span><span class="next"><a class="route-link" href="/my-notes/react/redux.html" aria-label="redux"><!--[--><!--]--> redux <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/my-notes/assets/app-CtA61ec0.js" defer></script>
  </body>
</html>
