<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.29">
    <title>ahooks | Gkc's notes</title><meta name="description" content="Record knowledge">
    <link rel="modulepreload" href="/my-notes/assets/app.c97851f0.js"><link rel="modulepreload" href="/my-notes/assets/ahooks.html.3ca8bb73.js"><link rel="modulepreload" href="/my-notes/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/my-notes/assets/ahooks.html.0331ebcc.js">
    <link rel="stylesheet" href="/my-notes/assets/style.4b916bd5.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/my-notes/" class=""><!----><span class="site-name can-hide">Gkc&#39;s notes</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a class="nav-link external" href="https://v2.vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress"><!--[--><!--]--> VuePress <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/goodboy-yes/my-node" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a class="nav-link external" href="https://v2.vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress"><!--[--><!--]--> VuePress <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/goodboy-yes/my-node" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">HTML</p><ul class=""><li><!--[--><a href="/my-notes/html/sample-template.html" class="nav-link sidebar-item" aria-label="示例模板"><!--[--><!--]--> 示例模板 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/html/knowledge-points.html" class="nav-link sidebar-item" aria-label="知识点"><!--[--><!--]--> 知识点 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">JS</p><ul class=""><li><!--[--><a href="/my-notes/js/knowledge-points.html" class="nav-link sidebar-item" aria-label="知识点"><!--[--><!--]--> 知识点 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/handwriting-knowledge.html" class="nav-link sidebar-item" aria-label="手写知识点"><!--[--><!--]--> 手写知识点 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/code-snippet.html" class="nav-link sidebar-item" aria-label="小技巧"><!--[--><!--]--> 小技巧 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/bit-operation.html" class="nav-link sidebar-item" aria-label="位运算"><!--[--><!--]--> 位运算 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/regular-expression.html" class="nav-link sidebar-item" aria-label="正则表达式"><!--[--><!--]--> 正则表达式 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/file-operation.html" class="nav-link sidebar-item" aria-label="文件操作"><!--[--><!--]--> 文件操作 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/cross-domain.html" class="nav-link sidebar-item" aria-label="跨域"><!--[--><!--]--> 跨域 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/code-style.html" class="nav-link sidebar-item" aria-label="代码风格"><!--[--><!--]--> 代码风格 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/performance-optimization.html" class="nav-link sidebar-item" aria-label="性能优化"><!--[--><!--]--> 性能优化 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/design-pattern.html" class="nav-link sidebar-item" aria-label="设计模式"><!--[--><!--]--> 设计模式 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/js/principle-analysis.html" class="nav-link sidebar-item" aria-label="原理分析"><!--[--><!--]--> 原理分析 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">TypeScript</p><ul class=""><li><!--[--><a href="/my-notes/ts/basic-knowledge.html" class="nav-link sidebar-item" aria-label="基础知识"><!--[--><!--]--> 基础知识 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/ts/to-use.html" class="nav-link sidebar-item" aria-label="如何使用"><!--[--><!--]--> 如何使用 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">CSS</p><ul class=""><li><!--[--><a href="/my-notes/css/knowledge-points.html" class="nav-link sidebar-item" aria-label="知识点"><!--[--><!--]--> 知识点 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/css/bfc.html" class="nav-link sidebar-item" aria-label="块级格式化上下文(BFC)"><!--[--><!--]--> 块级格式化上下文(BFC) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/css/pseudo-classes-and-elements.html" class="nav-link sidebar-item" aria-label="伪类和伪元素"><!--[--><!--]--> 伪类和伪元素 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/css/aspect-ratio.html" class="nav-link sidebar-item" aria-label="aspect-ratio"><!--[--><!--]--> aspect-ratio <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/css/skill.html" class="nav-link sidebar-item" aria-label="小技巧"><!--[--><!--]--> 小技巧 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/css/compositing-layer.html" class="nav-link sidebar-item" aria-label="合成层"><!--[--><!--]--> 合成层 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Vue2</p><ul class=""><li><!--[--><a href="/my-notes/vue2/knowledge-points.html" class="nav-link sidebar-item" aria-label="知识点"><!--[--><!--]--> 知识点 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/vue2/keep-alive.html" class="nav-link sidebar-item" aria-label="keep-alive"><!--[--><!--]--> keep-alive <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Vue3</p><ul class=""><li><!--[--><a href="/my-notes/vue3/difference-from-vue2.html" class="nav-link sidebar-item" aria-label="与 Vue2 不同点"><!--[--><!--]--> 与 Vue2 不同点 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/vue3/vite.html" class="nav-link sidebar-item" aria-label="Vite"><!--[--><!--]--> Vite <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/vue3/practice.html" class="nav-link sidebar-item" aria-label="实践"><!--[--><!--]--> 实践 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/vue3/style-guide.html" class="nav-link sidebar-item" aria-label="风格指南"><!--[--><!--]--> 风格指南 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><a href="/my-notes/react" class="nav-link router-link-active sidebar-heading sidebar-item active" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a><ul class=""><li><!--[--><a href="/my-notes/react/use.html" class="nav-link sidebar-item" aria-label="使用"><!--[--><!--]--> 使用 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/react/api.html" class="nav-link sidebar-item" aria-label="API"><!--[--><!--]--> API <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/react/react-router.html" class="nav-link sidebar-item" aria-label="react-router(V6)"><!--[--><!--]--> react-router(V6) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/react/umijs.html" class="nav-link sidebar-item" aria-label="umijs"><!--[--><!--]--> umijs <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/react/code-standard.html" class="nav-link sidebar-item" aria-label="代码规范"><!--[--><!--]--> 代码规范 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/react/redux.html" class="nav-link sidebar-item" aria-label="redux"><!--[--><!--]--> redux <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/react/dva.html" class="nav-link sidebar-item" aria-label="dva"><!--[--><!--]--> dva <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="ahooks"><!--[--><!--]--> ahooks <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#userequest" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="useRequest"><!--[--><!--]--> useRequest <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#默认请求" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="默认请求"><!--[--><!--]--> 默认请求 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#手动触发" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="手动触发"><!--[--><!--]--> 手动触发 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#生命周期" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="生命周期"><!--[--><!--]--> 生命周期 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#刷新-重复上一次请求" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="刷新（重复上一次请求）"><!--[--><!--]--> 刷新（重复上一次请求） <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#立即变更数据" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="立即变更数据"><!--[--><!--]--> 立即变更数据 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#取消请求" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="取消请求"><!--[--><!--]--> 取消请求 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#参数管理" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="参数管理"><!--[--><!--]--> 参数管理 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#api" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="API"><!--[--><!--]--> API <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#loading-delay" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Loading Delay"><!--[--><!--]--> Loading Delay <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#轮询" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="轮询"><!--[--><!--]--> 轮询 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#ready" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Ready"><!--[--><!--]--> Ready <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#依赖刷新" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="依赖刷新"><!--[--><!--]--> 依赖刷新 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#屏幕聚焦重新请求" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="屏幕聚焦重新请求"><!--[--><!--]--> 屏幕聚焦重新请求 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#防抖" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="防抖"><!--[--><!--]--> 防抖 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#节流" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="节流"><!--[--><!--]--> 节流 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#缓存-swr" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="缓存 &amp; SWR"><!--[--><!--]--> 缓存 &amp; SWR <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/my-notes/react/ahooks.html#错误重试" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="错误重试"><!--[--><!--]--> 错误重试 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--></li></ul><!--]--><!--[--><a href="/my-notes/node-js" class="nav-link sidebar-heading sidebar-item" aria-label="Nodejs"><!--[--><!--]--> Nodejs <!--[--><!--]--></a><!----><!--]--><!--[--><p class="sidebar-heading sidebar-item">Git</p><ul class=""><li><!--[--><a href="/my-notes/git/basic-command.html" class="nav-link sidebar-item" aria-label="用法"><!--[--><!--]--> 用法 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/git/commit-standard.html" class="nav-link sidebar-item" aria-label="commit 规范"><!--[--><!--]--> commit 规范 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/git/reset-and-revert.html" class="nav-link sidebar-item" aria-label="git reset 和 git revert 的区别"><!--[--><!--]--> git reset 和 git revert 的区别 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/git/commit-amend.html" class="nav-link sidebar-item" aria-label="git commit --amend"><!--[--><!--]--> git commit --amend <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Webpack</p><ul class=""><li><!--[--><a href="/my-notes/webpack/principle-analysis.html" class="nav-link sidebar-item" aria-label="原理分析"><!--[--><!--]--> 原理分析 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">开发实践</p><ul class=""><li><!--[--><a href="/my-notes/development-practice/functional-programming.html" class="nav-link sidebar-item" aria-label="函数式编程"><!--[--><!--]--> 函数式编程 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/development-practice/refactoring.html" class="nav-link sidebar-item" aria-label="重构"><!--[--><!--]--> 重构 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/development-practice/interactive.html" class="nav-link sidebar-item" aria-label="交互设计"><!--[--><!--]--> 交互设计 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/development-practice/technical-scheme.html" class="nav-link sidebar-item" aria-label="技术方案"><!--[--><!--]--> 技术方案 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">知识点</p><ul class=""><li><!--[--><a href="/my-notes/knowledge-point/algorithm.html" class="nav-link sidebar-item" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/my-notes/knowledge-point/network.html" class="nav-link sidebar-item" aria-label="网络"><!--[--><!--]--> 网络 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><a href="/my-notes/development-proposals" class="nav-link sidebar-heading sidebar-item" aria-label="发展建议"><!--[--><!--]--> 发展建议 <!--[--><!--]--></a><!----><!--]--><!--[--><a href="/my-notes/vs-code" class="nav-link sidebar-heading sidebar-item" aria-label="VSCode"><!--[--><!--]--> VSCode <!--[--><!--]--></a><!----><!--]--><!--[--><a href="/my-notes/docker" class="nav-link sidebar-heading sidebar-item" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a><!----><!--]--><!--[--><a href="/my-notes/collection" class="nav-link sidebar-heading sidebar-item" aria-label="收藏"><!--[--><!--]--> 收藏 <!--[--><!--]--></a><!----><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="ahooks" tabindex="-1"><a class="header-anchor" href="#ahooks" aria-hidden="true">#</a> ahooks</h1><h2 id="userequest" tabindex="-1"><a class="header-anchor" href="#userequest" aria-hidden="true">#</a> useRequest</h2><p>useRequest 是一个强大的异步数据管理的 Hooks</p><p>目前已有能力包括：</p><ul><li>自动请求/手动请求</li><li>轮询</li><li>防抖</li><li>节流</li><li>屏幕聚焦重新请求</li><li>错误重试</li><li>loading delay</li><li>SWR(stale-while-revalidate)</li><li>缓存</li></ul><h3 id="默认请求" tabindex="-1"><a class="header-anchor" href="#默认请求" aria-hidden="true">#</a> 默认请求</h3><p>默认情况下，<code>useRequest</code> 第一个参数是一个异步函数，在组件初始化时，<strong>会自动执行该异步函数</strong>。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> error<span class="token punctuation">,</span> loading <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>service<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="手动触发" tabindex="-1"><a class="header-anchor" href="#手动触发" aria-hidden="true">#</a> 手动触发</h3><p>设置了 <code>options.manual = true</code>，则 <code>useRequest</code> 不会默认执行，需要通过 <code>run</code> 或者 <code>runAsync</code> 来触发执行</p><p>run 与 runAsync 的区别在于：</p><ul><li>run 是一个普通的同步函数，我们会自动捕获异常，你可以通过 options.onError 来处理异常时的行为。</li><li>runAsync 是一个返回 Promise 的异步函数，如果使用 runAsync 来调用，则意味着你需要自己捕获异常。</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;antd&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> error<span class="token punctuation">,</span> loading<span class="token punctuation">,</span> run <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>editUsername<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  manual<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onSuccess</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">result<span class="token punctuation">,</span> params</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    message<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The username was changed to &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; !</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onError</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="生命周期" tabindex="-1"><a class="header-anchor" href="#生命周期" aria-hidden="true">#</a> 生命周期</h3><p><code>useRequest</code> 提供了以下几个生命周期配置项，供你在异步函数的不同阶段做一些处理。</p><ul><li>onBefore：请求之前触发</li><li>onSuccess：请求成功触发</li><li>onError：请求失败触发</li><li>onFinally：请求完成触发</li></ul><h3 id="刷新-重复上一次请求" tabindex="-1"><a class="header-anchor" href="#刷新-重复上一次请求" aria-hidden="true">#</a> 刷新（重复上一次请求）</h3><p>useRequest 提供了 <code>refresh</code> 和 <code>refreshAsync</code> 方法，使我们可以使用上一次的参数，重新发起请求。</p><h3 id="立即变更数据" tabindex="-1"><a class="header-anchor" href="#立即变更数据" aria-hidden="true">#</a> 立即变更数据</h3><p><code>useRequest</code> 提供了 <code>mutate</code>, 支持立即修改 <code>useRequest</code> 返回的 data 参数。</p><p><code>mutate</code> 的用法与 <code>React.setState</code>一致，支持 <code>mutate(newData)</code> 和 <code>mutate((oldData) =&gt; newData)</code> 两种写法。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> username<span class="token punctuation">,</span> mutate <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>getUsername<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="取消请求" tabindex="-1"><a class="header-anchor" href="#取消请求" aria-hidden="true">#</a> 取消请求</h3><p><code>useRequest</code> 提供了 <code>cancel</code> 函数，可以取消当前正在进行的请求。同时 <code>useRequest</code> 会在以下时机自动取消当前请求：</p><ul><li>组件卸载时，取消正在进行的请求</li><li>竞态取消，当上一次请求还没返回时，又发起了下一次请求，则会取消上一次请求</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> loading<span class="token punctuation">,</span> run<span class="token punctuation">,</span> cancel <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>editUsername<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  manual<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onSuccess</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">result<span class="token punctuation">,</span> params</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setState</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    message<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The username was changed to &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; !</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onError</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="参数管理" tabindex="-1"><a class="header-anchor" href="#参数管理" aria-hidden="true">#</a> 参数管理</h3><p><code>useRequest</code> 返回的 <code>params</code> 会记录当次调用 <code>service</code> 的参数数组。比如你触发了 <code>run(1, 2, 3)</code>，则 <code>params</code> 等于 <code>[1, 2, 3]</code> 。</p><p>如果我们设置了 <code>options.manual = false</code>，则首次调用 <code>service</code> 的参数可以通过 <code>options.defaultParams</code>来设置。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// get username</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>
  data<span class="token operator">:</span> username<span class="token punctuation">,</span>
  run<span class="token punctuation">,</span>
  params<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>getUsername<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  defaultParams<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="api" tabindex="-1"><a class="header-anchor" href="#api" aria-hidden="true">#</a> API</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>
  loading<span class="token operator">:</span> boolean<span class="token punctuation">,</span>
  data<span class="token operator">?</span><span class="token operator">:</span> TData<span class="token punctuation">,</span>
  error<span class="token operator">?</span><span class="token operator">:</span> Error<span class="token punctuation">,</span>
  params<span class="token operator">:</span> TParams <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function-variable function">run</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>params<span class="token operator">:</span> TParams</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
  <span class="token function-variable function">runAsync</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>params<span class="token operator">:</span> TParams</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Promise<span class="token operator">&lt;</span>TData<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">refresh</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
  <span class="token function-variable function">refreshAsync</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Promise<span class="token operator">&lt;</span>TData<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  mutate<span class="token operator">:</span> <span class="token punctuation">(</span>data<span class="token operator">?</span><span class="token operator">:</span> TData <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">oldData<span class="token operator">?</span><span class="token operator">:</span> TData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>TData <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
  <span class="token function-variable function">cancel</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> useRequest<span class="token operator">&lt;</span>TData<span class="token punctuation">,</span> TParams<span class="token operator">&gt;</span><span class="token punctuation">(</span>
  <span class="token function-variable function">service</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args<span class="token operator">:</span> TParams</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Promise<span class="token operator">&lt;</span>TData<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    manual<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">,</span>
    defaultParams<span class="token operator">?</span><span class="token operator">:</span> TParams<span class="token punctuation">,</span>
    onBefore<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">params<span class="token operator">:</span> TParams</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
    onSuccess<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token operator">:</span> TData<span class="token punctuation">,</span> params<span class="token operator">:</span> TParams</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
    onError<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> Error<span class="token punctuation">,</span> params<span class="token operator">:</span> TParams</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
    onFinally<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">params<span class="token operator">:</span> TParams<span class="token punctuation">,</span> data<span class="token operator">?</span><span class="token operator">:</span> TData<span class="token punctuation">,</span> e<span class="token operator">?</span><span class="token operator">:</span> Error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="loading-delay" tabindex="-1"><a class="header-anchor" href="#loading-delay" aria-hidden="true">#</a> Loading Delay</h3><p>通过设置 <code>options.loadingDelay</code> ，可以延迟 loading 变成 true 的时间，有效防止闪烁。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> loading<span class="token punctuation">,</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>getUsername<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  loadingDelay<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="轮询" tabindex="-1"><a class="header-anchor" href="#轮询" aria-hidden="true">#</a> 轮询</h3><p>通过设置 <code>options.pollingInterval</code>，进入轮询模式，useRequest 会定时触发 service 执行。</p><p>可以通过 <code>cancel</code> 来停止轮询，通过 <code>run/runAsync</code> 来启动轮询</p><p><code>pollingWhenHidden</code>：在页面隐藏时，是否继续轮询</p><ul><li><code>options.pollingInterval</code>、<code>options.pollingWhenHidden</code> 支持动态变化。</li><li>如果设置 <code>options.manual = true</code>，则初始化不会启动轮询，需要通过 <code>run/runAsync</code> 触发开始。</li><li>轮询原理是在每次请求完成后，等待 <code>pollingInterval</code> 时间，发起下一次请求。</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> run<span class="token punctuation">,</span> cancel <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>getUsername<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  pollingInterval<span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="ready" tabindex="-1"><a class="header-anchor" href="#ready" aria-hidden="true">#</a> Ready</h3><p><code>useRequest</code> 提供了一个 <code>options.ready</code> 参数，当其值为 false 时，请求永远都不会发出。</p><p>其具体行为如下：</p><ul><li>当 <code>manual=false</code> 自动请求模式时，每次 ready 从 false 变为 true 时，都会自动发起请求，会带上参数 options.defaultParams。</li><li>当 <code>manual=true</code> 手动请求模式时，只要 <code>ready=false</code>，则通过 <code>run/runAsync</code> 触发的请求都不会执行。</li></ul><h3 id="依赖刷新" tabindex="-1"><a class="header-anchor" href="#依赖刷新" aria-hidden="true">#</a> 依赖刷新</h3><p><code>useRequest</code> 提供了一个 <code>options.refreshDeps</code> 参数，当它的值变化后，会重新触发请求。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>userId<span class="token punctuation">,</span> setUserId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> run <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">getUserSchool</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  refreshDeps<span class="token operator">:</span> <span class="token punctuation">[</span>userId<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="屏幕聚焦重新请求" tabindex="-1"><a class="header-anchor" href="#屏幕聚焦重新请求" aria-hidden="true">#</a> 屏幕聚焦重新请求</h3><p>通过设置 <code>options.refreshOnWindowFocus</code>，在浏览器窗口 <code>refocus</code> 和 <code>revisible</code> 时，会重新发起请求。</p><p><code>focusTimespan</code>：重新请求间隔，单位为毫秒</p><p><code>options.refreshOnWindowFocus、options.focusTimespan</code> 支持动态变化。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>getUsername<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  refreshOnWindowFocus<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="防抖" tabindex="-1"><a class="header-anchor" href="#防抖" aria-hidden="true">#</a> 防抖</h3><p>通过设置 <code>options.debounceWait</code>，进入防抖模式，此时如果频繁触发 <code>run</code> 或者 <code>runAsync</code>，则会以防抖策略进行请求。</p><p>频繁触发 run，只会在最后一次触发结束后执行</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> run <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>getUsername<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  debounceWait<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
  manual<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="节流" tabindex="-1"><a class="header-anchor" href="#节流" aria-hidden="true">#</a> 节流</h3><p>通过设置 <code>options.throttleWait</code>，进入节流模式，此时如果频繁触发 <code>run</code> 或者 <code>runAsync</code>，则会以节流策略进行请求。</p><p>频繁触发 run，只会每隔 300ms 执行一次。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> run <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>getUsername<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  throttleWait<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
  manual<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="缓存-swr" tabindex="-1"><a class="header-anchor" href="#缓存-swr" aria-hidden="true">#</a> 缓存 &amp; SWR</h3><p>如果设置了 <code>options.cacheKey``，useRequest</code> 会将当前请求成功的数据缓存起来。下次组件初始化时，如果有缓存数据，我们会优先返回缓存数据，然后在背后发送新请求，也就是 SWR 的能力。</p><p>你可以通过 <code>options.staleTime</code> 设置数据保持新鲜时间，在该时间内，我们认为数据是新鲜的，不会重新发起请求。</p><p>你也可以通过 <code>options.cacheTime</code> 设置数据缓存时间，超过该时间，我们会清空该条缓存数据。</p><h3 id="错误重试" tabindex="-1"><a class="header-anchor" href="#错误重试" aria-hidden="true">#</a> 错误重试</h3><p>通过设置 <code>options.retryCount</code>，指定错误重试次数，则 <code>useRequest</code> 在失败后会进行重试。</p><p><code>cancel</code> 可以取消正在进行的重试行为</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> run <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>getUsername<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  retryCount<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: gkckx37@163.com">goodboy-yes</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/my-notes/react/dva.html" class="nav-link" aria-label="dva"><!--[--><!--]--> dva <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/my-notes/assets/app.c97851f0.js" defer></script>
  </body>
</html>
