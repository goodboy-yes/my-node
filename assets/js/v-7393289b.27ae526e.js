"use strict";(self.webpackChunkmy_notes=self.webpackChunkmy_notes||[]).push([[734],{3865:(e,a,n)=>{n.r(a),n.d(a,{data:()=>r});const r={key:"v-7393289b",path:"/development-practice/technical-scheme.html",title:"技术方案",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"时间库",slug:"时间库",children:[{level:3,title:"Moment.js",slug:"moment-js",children:[]},{level:3,title:"Day.js",slug:"day-js",children:[]},{level:3,title:"date-fns",slug:"date-fns",children:[]}]},{level:2,title:"文件下载",slug:"文件下载",children:[{level:3,title:"FileSaver.js",slug:"filesaver-js",children:[]}]},{level:2,title:"更多 NPM 包",slug:"更多-npm-包",children:[]},{level:2,title:"网页离开时的请求发送",slug:"网页离开时的请求发送",children:[]},{level:2,title:"解决 node_modules 中第三方库 bug",slug:"解决-node-modules-中第三方库-bug",children:[]}],filePathRelative:"development-practice/technical-scheme.md",git:{updatedTime:1632155746e3,contributors:[]}}},708:(e,a,n)=>{n.r(a),n.d(a,{default:()=>J});var r=n(6252);const l=(0,r._)("h1",{id:"技术方案",tabindex:"-1"},[(0,r._)("a",{class:"header-anchor",href:"#技术方案","aria-hidden":"true"},"#"),(0,r.Uk)(" 技术方案")],-1),s=(0,r._)("h2",{id:"时间库",tabindex:"-1"},[(0,r._)("a",{class:"header-anchor",href:"#时间库","aria-hidden":"true"},"#"),(0,r.Uk)(" 时间库")],-1),t={id:"moment-js",tabindex:"-1"},d=(0,r._)("a",{class:"header-anchor",href:"#moment-js","aria-hidden":"true"},"#",-1),i=(0,r.Uk)(),o={href:"http://momentjs.cn/",target:"_blank",rel:"noopener noreferrer"},c=(0,r.Uk)("Moment.js"),h=(0,r._)("p",null,"最知名、最古老的 JavaScript 日期处理类库",-1),p={id:"day-js",tabindex:"-1"},u=(0,r._)("a",{class:"header-anchor",href:"#day-js","aria-hidden":"true"},"#",-1),m=(0,r.Uk)(),b={href:"https://dayjs.fenxianglu.cn/",target:"_blank",rel:"noopener noreferrer"},_=(0,r.Uk)("Day.js"),g=(0,r._)("p",null,"Day.js 是一个极简的 JavaScript 库，可以为现代浏览器解析、验证、操作和显示日期和时间，是 Moment.js 替代方案(自 2020 年 9 月起进入纯维护模式,不再开发新版本）",-1),f={id:"date-fns",tabindex:"-1"},v=(0,r._)("a",{class:"header-anchor",href:"#date-fns","aria-hidden":"true"},"#",-1),k=(0,r.Uk)(),j={href:"https://date-fns.org/",target:"_blank",rel:"noopener noreferrer"},x=(0,r.Uk)("date-fns"),U=(0,r._)("p",null,"date-fns 提供了最全面、最简单且一致的工具集，用于在浏览器和 Node.js 中操作 JavaScript 日期。",-1),y=(0,r._)("h2",{id:"文件下载",tabindex:"-1"},[(0,r._)("a",{class:"header-anchor",href:"#文件下载","aria-hidden":"true"},"#"),(0,r.Uk)(" 文件下载")],-1),N={id:"filesaver-js",tabindex:"-1"},M=(0,r._)("a",{class:"header-anchor",href:"#filesaver-js","aria-hidden":"true"},"#",-1),S=(0,r.Uk)(),W={href:"https://github.com/eligrey/FileSaver.js/",target:"_blank",rel:"noopener noreferrer"},q=(0,r.Uk)("FileSaver.js"),P=(0,r._)("p",null,"FileSaver.js 在没有原生支持 saveAs() 的浏览器上实现了 saveAs() 接口。是文件下载的标杆项目。",-1),w=(0,r._)("h2",{id:"更多-npm-包",tabindex:"-1"},[(0,r._)("a",{class:"header-anchor",href:"#更多-npm-包","aria-hidden":"true"},"#"),(0,r.Uk)(" 更多 NPM 包")],-1),z={href:"https://juejin.cn/post/6950584088462163982",target:"_blank",rel:"noopener noreferrer"},C=(0,r.Uk)("让我告诉你一些强无敌的 NPM 软件包"),D=(0,r._)("h2",{id:"网页离开时的请求发送",tabindex:"-1"},[(0,r._)("a",{class:"header-anchor",href:"#网页离开时的请求发送","aria-hidden":"true"},"#"),(0,r.Uk)(" 网页离开时的请求发送")],-1),F={href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Navigator/sendBeacon",target:"_blank",rel:"noopener noreferrer"},A=(0,r.Uk)("Navigator.sendBeacon"),B=(0,r.uE)('<p>这个方法主要用于满足统计和诊断代码的需要，这些代码通常尝试在卸载（unload）文档之前向 web 服务器发送数据。</p><p>同步的 <code>XMLHttpRequest</code> 迫使用户代理延迟卸载文档，并使得下一个导航出现的更晚。有一些技术被用来保证数据的发送。其中一种是通过在卸载事件处理器中创建一个图片元素并设置它的 <code>src</code> 属性的方法来延迟卸载以保证数据的发送，但会延迟卸载以保证图片的载入</p><p>使用 <code>sendBeacon()</code> 方法会使用户代理在有机会时异步地向服务器发送数据，同时不会延迟页面的卸载或影响下一导航的载入性能。这就解决了提交分析数据时的所有的问题：数据可靠，传输异步并且不会影响下一页面的加载。此外，代码实际上还要比其他技术简单许多！</p><h2 id="解决-node-modules-中第三方库-bug" tabindex="-1"><a class="header-anchor" href="#解决-node-modules-中第三方库-bug" aria-hidden="true">#</a> 解决 node_modules 中第三方库 bug</h2><p>一般来说，解决 node_modules 中第三方库的 bug 大概有两种思路：</p><ul><li><p>第一种思路是将第三方库中有问题的文件 copy 一份进行修复，放在项目目录里面(非 node_modules)，然后通过构建工具 <code>resolve.alias</code> 能力重定向到修复后的位置。</p></li><li><p>另一种是通过 <code>patch-package</code> 记录 node_modules 更改记录，生成 patches 目录，然后通过项目的 post-install 脚本在团队中同步这个更改，实现第三方库的临时 patch，当然这也适合其他第三方库问题的临时修复。</p></li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>// 1. 安装\nyarn add patch-package postinstall-postinstall\n// 2. 修改 node_modules 代码后执行：\nyarn patch-package react-virtualized\n// 3. package.json 中 scripts 增加：\n{\n&quot;postinstall&quot;: &quot;patch-package&quot;\n}\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div>',7),J={render:function(e,a){const n=(0,r.up)("OutboundLink");return(0,r.wg)(),(0,r.iD)(r.HY,null,[l,s,(0,r._)("h3",t,[d,i,(0,r._)("a",o,[c,(0,r.Wm)(n)])]),h,(0,r._)("h3",p,[u,m,(0,r._)("a",b,[_,(0,r.Wm)(n)])]),g,(0,r._)("h3",f,[v,k,(0,r._)("a",j,[x,(0,r.Wm)(n)])]),U,y,(0,r._)("h3",N,[M,S,(0,r._)("a",W,[q,(0,r.Wm)(n)])]),P,w,(0,r._)("blockquote",null,[(0,r._)("p",null,[(0,r._)("a",z,[C,(0,r.Wm)(n)])])]),D,(0,r._)("p",null,[(0,r._)("a",F,[A,(0,r.Wm)(n)])]),B],64)}}}}]);