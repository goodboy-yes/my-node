# ä»£ç é£æ ¼

## ç¤¾åŒºä»£ç é£æ ¼æŒ‡å—

ä¸ºäº†çº¦å®šå¤§å®¶çš„ä»£ç é£æ ¼ï¼Œåœ¨ç¤¾åŒºä¸­è¯ç”Ÿäº†ä¸€äº›æ¯”è¾ƒè§„èŒƒçš„ä»£ç é£æ ¼æŒ‡å—ï¼š

- [Airbnb](https://github.com/airbnb/javascript)
- [Standard](https://github.com/standard/standard)
- [Google](https://google.github.io/styleguide/jsguide.html)

**è¿™ä¸‰ä»½ JavaScript ä»£ç é£æ ¼æŒ‡å—å€¼å¾—æˆ‘ä»¬åå¤å­¦ä¹ ï¼ŒæŒæ¡åï¼Œç¼–ç¨‹èƒ½åŠ›èƒ½ä¸Šä¸€å¤§å°é˜¶ã€‚**

## æ— åˆ†å·çš„ä»£ç é£æ ¼

å½“é‡‡ç”¨äº†æ— åˆ†å·çš„ä»£ç é£æ ¼æ—¶ï¼Œä»¥(ã€[ã€`å¼€å¤´éœ€è¦åœ¨å‰é¢è¡¥ä¸Šä¸€ä¸ªåˆ†å·ç”¨ä»¥é¿å…ä¸€äº›è¯­æ³•è§£æé”™è¯¯ã€‚æ‰€ä»¥ä½ ä¼šå‘ç°åœ¨ä¸€äº›ç¬¬ä¸‰æ–¹çš„ä»£ç ä¸­èƒ½çœ‹åˆ°ä¸€ä¸Šæ¥å°±ä»¥ä¸€ä¸ª ; å¼€å¤´ã€‚

```javascript
(function () {
  console.log("hello");
})();
`hello`.toString();
```

## ææ‡‚ editorconfigã€ ESLint å’Œ Prettier

### editorconfig

#### å®šä¹‰

å¸®åŠ©é¡¹ç›®ä¸­ä½¿ç”¨ä¸åŒ IDE å·¥å…·çš„å¼€å‘è€…ï¼Œç»´æŒå›ºå®šç»Ÿä¸€çš„ä»£ç é£æ ¼ã€‚ä¾‹å¦‚æŒ‰ Tab é”®å…‰æ ‡ç¼©è¿›å¤šå°‘ç©ºæ ¼æ•°ç­‰

#### ä½¿ç”¨ï¼ˆVSCodeï¼‰

å®‰è£…`EditorConfig for VS Code`æ’ä»¶

æ·»åŠ é…ç½®æ–‡ä»¶ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹å¢åŠ  `.editorconfig` æ–‡ä»¶ï¼Œä»¥ä¸‹æ˜¯é…ç½®ç¤ºä¾‹ï¼Œæ›´å¤šé…ç½®è¯¦æƒ…æŸ¥çœ‹ [http://editorconfig.org](http://editorconfig.org)

```editorconfig
# è¡¨ç¤ºæ˜¯æœ€é¡¶å±‚çš„ EditorConfig é…ç½®æ–‡ä»¶
root = true

[*] # è¡¨ç¤ºæ‰€æœ‰æ–‡ä»¶é€‚ç”¨
charset = utf-8 # è®¾ç½®æ–‡ä»¶å­—ç¬¦é›†ä¸º utf-8
indent_style = space # ç¼©è¿›é£æ ¼ï¼ˆtab | spaceï¼‰
indent_size = 2 # ç¼©è¿›å¤§å°
end_of_line = lf # æ§åˆ¶æ¢è¡Œç±»å‹(lf | cr | crlf)
trim_trailing_whitespace = true # å»é™¤è¡Œé¦–çš„ä»»æ„ç©ºç™½å­—ç¬¦
insert_final_newline = true # å§‹ç»ˆåœ¨æ–‡ä»¶æœ«å°¾æ’å…¥ä¸€ä¸ªæ–°è¡Œ

[*.md] # è¡¨ç¤ºä»… md æ–‡ä»¶é€‚ç”¨ä»¥ä¸‹è§„åˆ™
max_line_length = off
trim_trailing_whitespace = false
```

è™½ç„¶æ ¼å¼åŒ–çš„é…ç½®å‚æ•°å¾ˆå°‘ï¼Œä½†æ˜¯å®ƒè¿˜æ˜¯éå¸¸æœ‰å¿…è¦å­˜åœ¨çš„

- èƒ½å¤Ÿåœ¨ä¸åŒçš„ç¼–è¾‘å™¨å’Œ IDE ä¸­ä¿æŒä¸€è‡´çš„ä»£ç é£æ ¼ï¼›
- é…åˆæ’ä»¶æ‰“å¼€æ–‡ä»¶å³è‡ªåŠ¨æ ¼å¼åŒ–ï¼Œéå¸¸æ–¹ä¾¿
- æ”¯æŒæ ¼å¼åŒ–çš„æ–‡ä»¶ç±»å‹å¾ˆå¤šï¼›

### Prettier

#### å®šä¹‰

ä¸€æ¬¾å¼ºå¤§çš„ä»£ç æ ¼å¼åŒ–å·¥å…·ï¼Œæ”¯æŒ `JavaScriptã€TypeScriptã€CSSã€SCSSã€Lessã€JSXã€Angularã€Vueã€GraphQLã€JSONã€Markdown` ç­‰è¯­è¨€ã€‚Prettier å…³æ³¨**ä»£ç æ ¼å¼**é—®é¢˜ï¼Œå¦‚ä½¿ç”¨å•å¼•å·è¿˜æ˜¯åŒå¼•å·ã€å•è¡Œé•¿åº¦ç­‰

#### ä½¿ç”¨

å®‰è£… Prettier

```bash
npm i prettier -D
```

å®‰è£…**Prettier - Code formatter**æ’ä»¶ï¼ˆVSCodeï¼‰

åˆ›å»º Prettier é…ç½®æ–‡ä»¶ï¼Œä»¥ä¸‹æ˜¯é…ç½®ç¤ºä¾‹ï¼Œæ›´å¤šé…ç½®è¯¦æƒ…æŸ¥çœ‹ [Prettier-Options](https://prettier.io/docs/en/options.html) ã€‚

```js
{
  printWidth: 80,                    //ï¼ˆé»˜è®¤å€¼ï¼‰å•è¡Œä»£ç è¶…å‡º 80 ä¸ªå­—ç¬¦è‡ªåŠ¨æ¢è¡Œ
  tabWidth: 2,                       //ï¼ˆé»˜è®¤å€¼ï¼‰ä¸€ä¸ª tab é”®ç¼©è¿›ç›¸å½“äº 2 ä¸ªç©ºæ ¼
  useTabs: true,                     // è¡Œç¼©è¿›ä½¿ç”¨ tab é”®ä»£æ›¿ç©ºæ ¼
  semi: false,                       //ï¼ˆé»˜è®¤å€¼ï¼‰è¯­å¥çš„æœ«å°¾åŠ ä¸Šåˆ†å·
  singleQuote: true,                 // ä½¿ç”¨å•å¼•å·
  quoteProps: 'as-needed',           //ï¼ˆé»˜è®¤å€¼ï¼‰ä»…ä»…å½“å¿…é¡»çš„æ—¶å€™æ‰ä¼šåŠ ä¸ŠåŒå¼•å·
  jsxSingleQuote: true,              // åœ¨ JSX ä¸­ä½¿ç”¨å•å¼•å·
  trailingComma: 'all',              // ä¸ç”¨åœ¨å¤šè¡Œçš„é€—å·åˆ†éš”çš„å¥æ³•ç»“æ„çš„æœ€åä¸€è¡Œçš„æœ«å°¾åŠ ä¸Šé€—å·, "none":å°¾éšé€—å·
  bracketSpacing: true,              //ï¼ˆé»˜è®¤å€¼ï¼‰åœ¨æ‹¬å·å’Œå¯¹è±¡çš„æ–‡å­—ä¹‹é—´åŠ ä¸Šä¸€ä¸ªç©ºæ ¼
  jsxBracketSameLine: true,          // æŠŠ > ç¬¦å·æ”¾åœ¨å¤šè¡Œçš„ JSX å…ƒç´ çš„æœ€åä¸€è¡Œ
  arrowParens: 'avoid',              // å½“ç®­å¤´å‡½æ•°ä¸­åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ—¶å€™å¯ä»¥å¿½ç•¥æ‹¬å¼§
  htmlWhitespaceSensitivity: 'ignore', // vue template ä¸­çš„ç»“æŸæ ‡ç­¾ç»“å°¾å°–æ‹¬å·æ‰åˆ°äº†ä¸‹ä¸€è¡Œ
  vueIndentScriptAndStyle: false,    //ï¼ˆé»˜è®¤å€¼ï¼‰å¯¹äº .vue æ–‡ä»¶ï¼Œä¸ç¼©è¿› <script> å’Œ <style> é‡Œçš„å†…å®¹
  embeddedLanguageFormatting: 'auto', //ï¼ˆé»˜è®¤å€¼ï¼‰å…è®¸è‡ªåŠ¨æ ¼å¼åŒ–å†…åµŒçš„ä»£ç å—
}
```

```
  # å°†æ ¼å¼åŒ–å½“å‰ç›®å½•åŠå­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶
  npx prettier --write .

  //æ£€æŸ¥æŸä¸ªæ–‡ä»¶æ˜¯å¦å·²ç»æ ¼å¼åŒ–
  npx prettier --check src/main.js
```

å¦‚æœæœ‰äº›æ–‡ä»¶ä¸æƒ³è¢« Prettier æ ¼å¼åŒ–ï¼Œå¯ä»¥å°†å…¶å†™å…¥åˆ° .prettierignore é‡Œï¼š

```javascript
build/
package.json
test/*.*
```

### ESLint

#### å®šä¹‰

**ESLint**æ˜¯ä¸€æ¬¾ç”¨äºæŸ¥æ‰¾å¹¶æŠ¥å‘Šä»£ç ä¸­é—®é¢˜çš„å·¥å…·ï¼Œå…³æ³¨ç‚¹æ˜¯**ä»£ç è´¨é‡**å’Œ**ä»£ç æ ¼å¼**ï¼Œå¯ä»¥è¿›è¡Œé”™è¯¯æç¤ºå’Œè‡ªåŠ¨ä¿®å¤ï¼Œå…¶æ ¸å¿ƒæ˜¯é€šè¿‡å¯¹ä»£ç è§£æå¾—åˆ°çš„ ASTï¼ˆAbstract Syntax Tree æŠ½è±¡è¯­æ³•æ ‘ï¼‰è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼Œæ¥åˆ†æä»£ç è¾¾åˆ°æ£€æŸ¥ä»£ç è´¨é‡å’Œé£æ ¼é—®é¢˜çš„èƒ½åŠ›ã€‚

**ä»£ç è´¨é‡é—®é¢˜ï¼šä½¿ç”¨æ–¹å¼æœ‰å¯èƒ½æœ‰é—®é¢˜(problematic patterns)**ï¼Œå¦‚ç¦æ­¢æœªä½¿ç”¨çš„å˜é‡ã€ç¦æ­¢ä¸å¿…è¦çš„å‡½æ•°ç»‘å®šã€å…¨å±€å˜é‡å£°æ˜ç­‰é—®é¢˜

**ä»£ç é£æ ¼é—®é¢˜ï¼šé£æ ¼ä¸ç¬¦åˆä¸€å®šè§„åˆ™ (doesnâ€™t adhere to certain style guidelines)**ï¼Œå¦‚å•åŒå¼•å·ï¼Œæœ«å°¾åˆ†å·ç­‰

**è§£æå™¨**

ESLint çš„è§£æå™¨ï¼Œæ—©æœŸçš„æ—¶å€™ç”¨çš„æ˜¯ `Esprima`ï¼Œåé¢åŸºäº `Esprima v1.2.2` ç‰ˆæœ¬å¼€å‘äº†ä¸€ä¸ªæ–°çš„è§£æå™¨ `Espree`ï¼Œå¹¶ä¸”æŠŠå®ƒå½“åšé»˜è®¤è§£æå™¨ã€‚

é™¤äº†ä½¿ç”¨ ESLint è‡ªå¸¦çš„è§£æå™¨å¤–ï¼Œè¿˜å¯ä»¥æŒ‡å®šå…¶ä»–è§£æå™¨ï¼š

- `@babel/eslint-parser`ï¼šä½¿ Babel å’Œ ESLint å…¼å®¹ï¼Œå¯¹ä¸€äº› Babel è¯­æ³•æä¾›æ”¯æŒï¼›
- `@typescript-eslint/parser`ï¼šTSLint è¢«å¼ƒç”¨åï¼ŒTypeScript æä¾›äº†æ­¤è§£æå™¨ç”¨äºå°†å…¶ä¸ ESTree å…¼å®¹ï¼Œä½¿ ESLint å¯¹ TypeScript è¿›è¡Œæ”¯æŒï¼›

ä¸ºé¡¹ç›®æŒ‡å®šæŸä¸ªé€‰æ‹©å™¨çš„åŸåˆ™æ˜¯ä»€ä¹ˆï¼Ÿ

- å¦‚æœä½ çš„é¡¹ç›®ç”¨åˆ°äº†æ¯”è¾ƒæ–°çš„ ES è¯­æ³•ï¼Œæ¯”å¦‚ ES2021 çš„ Promise.any()ï¼Œé‚£å°±å¯ä»¥æŒ‡å®š @babel/eslint-parser ä¸ºè§£æå™¨ï¼›
- å¦‚æœé¡¹ç›®æ˜¯åŸºäº TS å¼€å‘çš„ï¼Œé‚£å°±ä½¿ç”¨ @typescript-eslint/parserï¼›

**ç¯å¢ƒ env**

æŒ‡å®šä¸åŒçš„ç¯å¢ƒå¯ä»¥ç»™å¯¹åº”ç¯å¢ƒä¸‹æä¾›é¢„è®¾çš„å…¨å±€å˜é‡ã€‚æ¯”å¦‚è¯´åœ¨ browser ç¯å¢ƒä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ window å…¨å±€å˜é‡ï¼›åœ¨ node ç¯å¢ƒä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ process å…¨å±€å˜é‡ç­‰ï¼›

[å®Œæ•´çš„ç¯å¢ƒåˆ—è¡¨](https://eslint.org/docs/user-guide/configuring/language-options#specifying-environments)

- browserï¼šæµè§ˆå™¨å…¨å±€å˜é‡ï¼›
- nodeï¼šNode.js å…¨å±€å˜é‡å’Œä½œç”¨åŸŸï¼›
- es6ï¼šes6 ä¸­é™¤äº†æ¨¡å—ä¹‹å¤–çš„å…¶ä»–ç‰¹æ€§ï¼ŒåŒæ—¶å°†è‡ªåŠ¨è®¾ç½® parserOptions.ecmaVersion å‚æ•°ä¸º 6ï¼›ä»¥æ­¤ç±»æ¨ - ES2017 æ˜¯ 7ï¼Œè€Œ ES2021 æ˜¯ 12ï¼›
- es2017ï¼šparserOptions.ecmaVersion ä¸º 8ï¼›

```javascript
{
    env: {
        browser: true,
        node: true,
        es6: true,
        commonjs: true,
        mocha: true,
        jquery: true,
    }
}
```

**å…¨å±€å˜é‡ globals**

ESLint çš„ä¸€äº›æ ¸å¿ƒè§„åˆ™ä¾èµ–äºå¯¹ä»£ç åœ¨è¿è¡Œæ—¶å¯ç”¨çš„å…¨å±€å˜é‡çš„äº†è§£ã€‚ç”±äºè¿™äº›åœ¨ä¸åŒç¯å¢ƒä¹‹é—´å¯èƒ½ä¼šæœ‰å¾ˆå¤§å·®å¼‚ï¼Œå¹¶ä¸”åœ¨è¿è¡Œæ—¶ä¼šè¿›è¡Œä¿®æ”¹ï¼Œå› æ­¤ ESLint ä¸ä¼šå‡è®¾ä½ çš„æ‰§è¡Œç¯å¢ƒä¸­å­˜åœ¨å“ªäº›å…¨å±€å˜é‡ã€‚

å¦‚æœä½ æƒ³ä½¿ç”¨è¿™äº›å…¨å±€å˜é‡ï¼Œé‚£å°±å¯ä»¥é€šè¿‡ globals æ¥æŒ‡å®šã€‚æ¯”å¦‚åœ¨ `react .eslintrc.js`é‡Œå°±æŠŠ `spyOnDev`ã€ `spyOnProd` ç­‰å˜é‡æŒ‚åœ¨äº† global ä¸‹ä½œä¸ºå…¨å±€å˜é‡ï¼š

```javascript
{
    globals: {
        spyOnDev: true,
        spyOnProd: true,
    }
}
```

falseã€readableã€readonly è¿™ 3 ä¸ªæ˜¯ç­‰ä»·çš„ï¼Œè¡¨ç¤ºå˜é‡åªå¯è¯»ä¸å¯å†™ï¼›

trueã€writeableã€writable è¿™ 3 ä¸ªæ˜¯ç­‰ä»·çš„ï¼Œè¡¨ç¤ºå˜é‡å¯è¯»å¯å†™ï¼›

**æ‰©å±• extends**

å®é™…é¡¹ç›®ä¸­é…ç½®è§„åˆ™æ—¶é€šå¸¸çš„åšæ³•æ˜¯ä½¿ç”¨ä¸šå†…å¤§å®¶æ™®é€šä½¿ç”¨çš„ã€éµå¾ªçš„ç¼–ç è§„èŒƒï¼›ç„¶åé€šè¿‡ extends å»å¼•å…¥è¿™äº›è§„èŒƒã€‚

extends é…ç½®çš„æ—¶å€™æ¥å—å­—ç¬¦ä¸²æˆ–è€…æ•°ç»„ï¼š

```javascript
{
    extends: [
        'eslint:recommended',
        'plugin:vue/essential',
        'eslint-config-standard', // å¯ä»¥ç¼©å†™æˆ 'standard'
        '@vue/prettier',
        './node_modules/coding-standard/.eslintrc-es6'
    ]
}
```

extends æ”¯æŒçš„é…ç½®ç±»å‹å¯ä»¥æ˜¯ä»¥ä¸‹å‡ ç§

- eslint å¼€å¤´çš„ï¼šæ˜¯ ESLint å®˜æ–¹çš„æ‰©å±•ï¼›
- plugin å¼€å¤´çš„ï¼šæ˜¯æ’ä»¶ç±»å‹æ‰©å±•ï¼Œæ¯”å¦‚ plugin:vue/essentialï¼›
- eslint-config å¼€å¤´çš„ï¼šæ¥è‡ª npm åŒ…ï¼Œä½¿ç”¨æ—¶å¯ä»¥çœç•¥å‰ç¼€ eslint-config-ï¼Œæ¯”å¦‚ä¸Šé¢çš„å¯ä»¥ç›´æ¥å†™æˆ standardï¼›
- @å¼€å¤´çš„ï¼šæ‰©å±•å’Œ eslint-config ä¸€æ ·ï¼Œåªæ˜¯åœ¨ npm åŒ…ä¸Šé¢åŠ äº†ä¸€å±‚ä½œç”¨åŸŸ scopeï¼›
- ä¸€ä¸ªæ‰§è¡Œé…ç½®æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ï¼›

å¸¸ç”¨çš„ã€æ¯”è¾ƒè‘—åçš„æ‰©å±•:

- `eslint:recommendedï¼šESLint` å†…ç½®çš„æ¨èè§„åˆ™ï¼Œå³ ESLint Rules åˆ—è¡¨ä¸­æ‰“äº†é’©çš„é‚£äº›è§„åˆ™ï¼›
- `eslint:allï¼šESLint` å†…ç½®çš„æ‰€æœ‰è§„åˆ™ï¼›
- `eslint-config-standard`ï¼šstandard çš„ JS è§„èŒƒï¼›
- `eslint-config-prettier`ï¼šå…³é—­å’Œ ESLint ä¸­ä»¥åŠå…¶ä»–æ‰©å±•ä¸­æœ‰å†²çªçš„è§„åˆ™ï¼›
- `eslint-config-airbnb-base`ï¼šairbab çš„ JS è§„èŒƒï¼›
- `eslint-config-alloy`ï¼šè…¾è®¯ AlloyTeam å‰ç«¯å›¢é˜Ÿå‡ºå“ï¼Œå¯ä»¥å¾ˆå¥½çš„é’ˆå¯¹ä½ é¡¹ç›®çš„æŠ€æœ¯æ ˆè¿›è¡Œé…ç½®é€‰æ‹©ï¼Œæ¯”å¦‚å¯ä»¥é€‰ Reactã€Vueï¼ˆç°å·²æ”¯æŒ Vue 3.0ï¼‰ã€TypeScript ç­‰ï¼›

**æ’ä»¶ plugins**

ESLint è™½ç„¶å¯ä»¥å®šä¹‰å¾ˆå¤šçš„ rulesï¼Œä»¥åŠé€šè¿‡ extends æ¥å¼•å…¥æ›´å¤šçš„è§„åˆ™ï¼Œä½†æ˜¯åªæ˜¯æ£€æŸ¥ JS è¯­æ³•ï¼Œæ— æ³•æ£€æŸ¥ Vue ä¸­çš„ template æˆ–è€… React ä¸­çš„ jsxï¼Œæ‰€ä»¥å¼•å…¥æ’ä»¶çš„ç›®çš„å°±æ˜¯ä¸ºäº†å¢å¼º ESLint çš„æ£€æŸ¥èƒ½åŠ›å’ŒèŒƒå›´ã€‚

ESLint ç›¸å…³çš„æ’ä»¶çš„å‘½åå½¢å¼æœ‰ 2 ç§ï¼šä¸å¸¦å‘½åç©ºé—´çš„å’Œå¸¦å‘½åç©ºé—´çš„ï¼Œæ¯”å¦‚ï¼š

- eslint-plugin- å¼€å¤´çš„å¯ä»¥çœç•¥è¿™éƒ¨åˆ†å‰ç¼€ï¼›
- @/ å¼€å¤´çš„ï¼›

å½“éœ€è¦åŸºäºæ’ä»¶è¿›è¡Œ extends å’Œ rules çš„é…ç½®çš„æ—¶å€™ï¼Œéœ€è¦åŠ ä¸Šæ’ä»¶çš„å¼•ç”¨

```javascript
{
    plugins: [
        'jquery',   // æ˜¯æŒ‡eslint-plugin-jquery
        '@foo/foo', // æ˜¯æŒ‡@foo/eslint-plugin-foo
        '@bar',      // æ˜¯æŒ‡@bar/eslint-plugin
    ],
    extends: [
        'plugin:jquery/recommended',
        'plugin:@foo/foo/recommended',
        'plugin:@bar/recommended'
    ],
    rules: {
        'jquery/a-rule': 'error',
        '@foo/foo/some-rule': 'error',
        '@bar/another-rule': 'error'
    },
}

```

**è§„åˆ™ rules**

ESLint æä¾›äº†å¤§é‡å†…ç½®çš„è§„åˆ™([ESLint Rules](https://eslint.org/docs/rules/))ï¼Œé™¤æ­¤ä¹‹å¤–ä½ è¿˜å¯ä»¥é€šè¿‡æ’ä»¶æ¥æ·»åŠ æ›´å¤šçš„è§„åˆ™ã€‚

è§„åˆ™çš„æ ¡éªŒè¯´æ˜ï¼Œæœ‰ 3 ä¸ªæŠ¥é”™ç­‰çº§

- off æˆ– 0ï¼šå…³é—­å¯¹è¯¥è§„åˆ™çš„æ ¡éªŒï¼›
- warn æˆ– 1ï¼šå¯ç”¨è§„åˆ™ï¼Œä¸æ»¡è¶³æ—¶æŠ›å‡ºè­¦å‘Šï¼Œä¸”ä¸ä¼šé€€å‡ºç¼–è¯‘è¿›ç¨‹ï¼›
- error æˆ– 2ï¼šå¯ç”¨è§„åˆ™ï¼Œä¸æ»¡è¶³æ—¶æŠ›å‡ºé”™è¯¯ï¼Œä¸”ä¼šé€€å‡ºç¼–è¯‘è¿›ç¨‹ï¼›

é€šå¸¸è§„åˆ™åªéœ€è¦é…ç½®å¼€å¯è¿˜æ˜¯å…³é—­å³å¯ï¼›ä½†æ˜¯ä¹Ÿæœ‰äº›è§„åˆ™å¯ä»¥ä¼ å…¥å±æ€§ï¼Œæ¯”å¦‚ï¼š

```javascript
{
    rules: {
        'quotes': ['error', 'single'],  // å¦‚æœä¸æ˜¯å•å¼•å·ï¼Œåˆ™æŠ¥é”™
        'one-var': ['error', {
            'var': 'always',  // æ¯ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­ï¼Œåªå…è®¸ 1 ä¸ª var å£°æ˜
            'let': 'never',   // æ¯ä¸ªå—ä½œç”¨åŸŸä¸­ï¼Œå…è®¸å¤šä¸ª let å£°æ˜
            'const': 'never', // æ¯ä¸ªå—ä½œç”¨åŸŸä¸­ï¼Œå…è®¸å¤šä¸ª const å£°æ˜
        }]
    }
}
```

è§„åˆ™çš„ä¼˜å…ˆçº§

- å¦‚æœ extends é…ç½®çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆæœ€ç»ˆä¼šå°†æ‰€æœ‰è§„åˆ™é¡¹è¿›è¡Œåˆå¹¶ï¼Œå‡ºç°å†²çªçš„æ—¶å€™ï¼Œåé¢çš„ä¼šè¦†ç›–å‰é¢çš„ï¼›
- é€šè¿‡ rules å•ç‹¬é…ç½®çš„è§„åˆ™ä¼˜å…ˆçº§æ¯” extends é«˜ï¼›

**ESLint æ£€æµ‹é…ç½®æ–‡ä»¶**

- åœ¨è¦æ£€æµ‹çš„æ–‡ä»¶åŒä¸€ç›®å½•é‡Œå¯»æ‰¾ .eslintrc.\* å’Œ package.jsonï¼›
- ç´§æ¥ç€åœ¨çˆ¶çº§ç›®å½•é‡Œå¯»æ‰¾ï¼Œä¸€ç›´åˆ°æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•ï¼›
- å¦‚æœåœ¨å‰ä¸¤æ­¥å‘ç°æœ‰ rootï¼štrue çš„é…ç½®ï¼Œåœæ­¢åœ¨çˆ¶çº§ç›®å½•ä¸­å¯»æ‰¾ .eslintrcï¼›
- å¦‚æœä»¥ä¸Šæ­¥éª¤éƒ½æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™å›é€€åˆ°ç”¨æˆ·ä¸»ç›®å½• ~/.eslintrc ä¸­è‡ªå®šä¹‰çš„é»˜è®¤é…ç½®ï¼›

é€šå¸¸æˆ‘ä»¬éƒ½ä¹ æƒ¯æŠŠ ESLint é…ç½®æ–‡ä»¶æ”¾åˆ°é¡¹ç›®æ ¹ç›®å½•ï¼Œå› æ­¤å¯ä»¥ä¸ºäº†é¿å… ESLint æ ¡éªŒçš„æ—¶å€™å¾€çˆ¶çº§ç›®å½•æŸ¥æ‰¾é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­åŠ ä¸Š `root: true`ã€‚

```javascript
{
  root: true,
}

```

**settings å…±äº«æ•°æ®**

ESLint æ”¯æŒåœ¨é…ç½®æ–‡ä»¶æ·»åŠ å…±äº«è®¾ç½®ï¼Œä½ å¯ä»¥æ·»åŠ  settings å¯¹è±¡åˆ°é…ç½®æ–‡ä»¶ï¼Œå®ƒå°†æä¾›ç»™æ¯ä¸€ä¸ªå°†è¢«æ‰§è¡Œçš„è§„åˆ™ã€‚å¦‚æœä½ æƒ³æ·»åŠ çš„è‡ªå®šä¹‰è§„åˆ™è€Œä¸”ä½¿å®ƒä»¬å¯ä»¥è®¿é—®åˆ°ç›¸åŒçš„ä¿¡æ¯ï¼Œè¿™å°†ä¼šå¾ˆæœ‰ç”¨

```javascript
{
    settings: {
        sharedData: 'Hello'
    },
}

```

**overrides å·®å¼‚åŒ–é…ç½®**

æ¯”å¦‚ webpack çš„ä¸­åŒ…å«äº†æŸäº›è¿è¡Œæ—¶çš„ JS æ–‡ä»¶ï¼Œè€Œè¿™äº›æ–‡ä»¶æ˜¯åªè·‘åœ¨æµè§ˆå™¨ç«¯çš„ï¼Œæ‰€ä»¥éœ€è¦é’ˆå¯¹è¿™éƒ¨åˆ†æ–‡ä»¶è¿›è¡Œå·®å¼‚åŒ–é…ç½®ï¼š

```javascript
overrides: [
  {
    files: ["lib/**/*.runtime.js", "hot/*.js"],
    env: {
      es6: false,
      browser: true,
    },
    globals: {
      Promise: false,
    },
    parserOptions: {
      ecmaVersion: 5,
    },
  },
];
```

#### ä½¿ç”¨

**å®‰è£… ESLint**

```bash
npm i eslint -D
```

**ä¸‹è½½ ESLint æ’ä»¶ï¼ˆVSCodeï¼‰**

**é…ç½® ESLint**

ESLint å®‰è£…æˆåŠŸåï¼Œæ‰§è¡Œ `npx eslint --init`ï¼Œç„¶åæŒ‰ç…§ç»ˆç«¯æ“ä½œæç¤ºå®Œæˆä¸€ç³»åˆ—è®¾ç½®æ¥åˆ›å»ºé…ç½®æ–‡ä»¶ã€‚

ESLint ä¸ºæˆ‘ä»¬åˆ—å‡ºäº†ä¸‰ç§ç¤¾åŒºæµè¡Œçš„ JavaScript é£æ ¼æŒ‡å—ï¼Œåˆ†åˆ«æ˜¯ [Airbnb](https://github.com/airbnb/javascript)ã€[Standard](https://github.com/standard/standard)ã€Googleã€‚ GitHub ä¸Š star æœ€å¤šçš„æ˜¯ Airbnbï¼Œå¯ä»¥ç›´æ¥é€‰ç”¨ Airbnbï¼Œå…å»ç¹ççš„é…ç½® ESLint è§„åˆ™æ—¶é—´ï¼Œç„¶åè®©å›¢é˜Ÿæˆå‘˜å»å­¦ä¹  Airbnb JavaScript é£æ ¼æŒ‡å—å³å¯ã€‚

é…ç½®å®Œæˆåä¼šåœ¨æ ¹ç›®å½•ç”Ÿæˆ`.eslintrc.js`ï¼Œæ ¹æ®é¡¹ç›®å®é™…æƒ…å†µï¼Œå¦‚æœæˆ‘ä»¬æœ‰é¢å¤–çš„ ESLint è§„åˆ™ï¼Œä¹Ÿåœ¨æ­¤æ–‡ä»¶ä¸­è¿½åŠ ã€‚

ä¾‹å¦‚ï¼š

```js
module.exports = {
  env: {
    browser: true,
    es2021: true,
    node: true,
  },
  extends: ["plugin:vue/essential", "airbnb-base"],
  parserOptions: {
    ecmaVersion: 12,
    // æŒ‡å®šè§£æå™¨
    parser: "@typescript-eslint/parser",
    sourceType: "module",
  },
  plugins: ["vue", "@typescript-eslint"],
  rules: {},
};
```

**è®¾ç½®ä¿å­˜è‡ªåŠ¨æ ¼å¼åŒ–**

VSCode åœ¨ `settings.json` è®¾ç½®æ–‡ä»¶ä¸­ï¼Œå¢åŠ ä»¥ä¸‹ä»£ç ï¼š

```js
 "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
 }
```

**å‘½ä»¤è¡Œæ ¡éªŒæ–‡ä»¶**

```javascript
// æ ¡éªŒ a.js å’Œ b.js
npx eslint a.js b.js

// æ ¡éªŒ src å’Œ scripts ç›®å½•
npx eslint src scripts

// é€šè¿‡ --ext æ¥æŒ‡å®šå…·ä½“éœ€è¦æ ¡éªŒçš„æ–‡ä»¶ï¼ŒESLint åªèƒ½æ ¡éªŒ JS æ–‡ä»¶ï¼Œ
//å¦‚å½“æ ¡éªŒ .vue æ–‡ä»¶ï¼Œå…‰é…ç½® vue æ’ä»¶å’Œ vue-eslint-parser è§£æå™¨æ˜¯ä¸å¤Ÿçš„
npx eslint --ext .js,.jsx,.vue src
```

**è‡ªåŠ¨ä¿®å¤éƒ¨åˆ†æ ¡éªŒé”™è¯¯çš„ä»£ç **

rules åˆ—è¡¨é¡¹ä¸­æ ‡è¯†äº†ä¸€ä¸ªæ‰³æ‰‹ ğŸ”§ å›¾æ¡ˆçš„è§„åˆ™å°±æ ‡è¯†è¯¥è§„åˆ™æ˜¯å¯ä»¥é€šè¿‡ ESLint å·¥å…·è‡ªåŠ¨ä¿®å¤ä»£ç çš„ã€‚

```javascript
npx eslint --fix a.js
```

ä¸€èˆ¬è¾ƒé•¿å‘½ä»¤å†™åœ¨ pakeage.json

```javascript
  {
    "scripts": {
        "lint": "npx eslint --ext .js,.jsx,.vue src",
        "lint:fix": "npx eslint --fix --ext .js,.jsx,.vue src",
    }
  }
```

**å¿½ç•¥æ ¡éªŒæ–‡ä»¶**

ESLint æ€»æ˜¯å¿½ç•¥ `/node_modules/` å’Œ `/bower_components/` ä¸­çš„æ–‡ä»¶ï¼Œå¯¹äºä¸€äº›å…¬å…±çš„ JSã€æµ‹è¯•è„šæœ¬æˆ–è€…æ˜¯ç‰¹å®šç›®å½•ä¸‹çš„æ–‡ä»¶ä¹ æƒ¯ä¸Šæ˜¯ä¸éœ€è¦æ ¡éªŒçš„ï¼Œå› æ­¤å¯ä»¥åœ¨é¡¹ç›®æ ¹ç›®å½•é€šè¿‡åˆ›å»ºä¸€ä¸ª `.eslintignore` æ–‡ä»¶æ¥é…ç½®

```javascript
public/;
src/main.js
```

### è§£å†³ Prettier å’Œ ESLint çš„å†²çª

ä½†åœ¨é¡¹ç›®ä¸­åŒæ—¶ä½¿ç”¨`Prettier` å’Œ `ESLint`æ—¶ï¼Œè§„åˆ™å¯èƒ½å…³äºå‘ç”Ÿå†²çªã€‚ä¾‹å¦‚`Airbnb JavaScript` é£æ ¼ä¸­ä»£ç ç»“æŸåé¢è¦åŠ åˆ†å·ï¼Œ`Prettier` é…ç½®æ–‡ä»¶ä¸­å¦‚æœåŠ äº†ä»£ç ç»“æŸåé¢ä¸åŠ åˆ†å·çš„é…ç½®é¡¹ï¼Œè¿™æ ·å°±æœ‰å†²çªäº†ï¼Œä¼šå‡ºç°ç”¨ `Prettier` æ ¼å¼åŒ–åçš„ä»£ç ï¼Œ`ESLint` æ£€æµ‹åˆ°æ ¼å¼æœ‰é—®é¢˜çš„ï¼Œä»è€ŒæŠ›å‡ºé”™è¯¯æç¤ºã€‚

è§£å†³ä¸¤è€…å†²çªé—®é¢˜ï¼Œéœ€è¦ç”¨åˆ° **eslint-plugin-prettier** å’Œ **eslint-config-prettier**ã€‚

- `eslint-plugin-prettier` å°† Prettier çš„è§„åˆ™è®¾ç½®åˆ° ESLint çš„è§„åˆ™ä¸­ã€‚
- `eslint-config-prettier` å…³é—­ ESLint ä¸­ä¸ Prettier ä¸­ä¼šå‘ç”Ÿå†²çªçš„è§„åˆ™ã€‚

æœ€åå½¢æˆä¼˜å…ˆçº§ï¼š`Prettier é…ç½®è§„åˆ™` > `ESLint é…ç½®è§„åˆ™`ã€‚

**ä½¿ç”¨**

å®‰è£…æ’ä»¶

```bash
npm i eslint-plugin-prettier eslint-config-prettier -D
```

åœ¨ `.eslintrc.js` æ·»åŠ  prettier æ’ä»¶

```js
module.exports = {
  ...
  extends: [
    'plugin:prettier/recommended' // æ·»åŠ  prettier æ’ä»¶
  ],
  ...
}
```

è¿™æ ·ï¼Œæˆ‘ä»¬åœ¨æ‰§è¡Œ `eslint --fix` å‘½ä»¤æ—¶ï¼ŒESLint å°±ä¼šæŒ‰ç…§ Prettier çš„é…ç½®è§„åˆ™æ¥æ ¼å¼åŒ–ä»£ç 

### é›†æˆ husky å’Œ lint-staged

æˆ‘ä»¬å¯ä»¥åšä¸€äº›é™åˆ¶ï¼Œè®©æ²¡é€šè¿‡ ESLint æ£€æµ‹å’Œä¿®å¤çš„ä»£ç ç¦æ­¢æäº¤ï¼Œä»è€Œä¿è¯ä»“åº“ä»£ç éƒ½æ˜¯ç¬¦åˆè§„èŒƒçš„ã€‚
æˆ‘ä»¬éœ€è¦ç”¨åˆ° Git Hookï¼Œåœ¨æœ¬åœ°æ‰§è¡Œ git commit çš„æ—¶å€™ï¼Œå°±å¯¹æ‰€æäº¤çš„ä»£ç è¿›è¡Œ ESLint æ£€æµ‹å’Œä¿®å¤ï¼ˆå³æ‰§è¡Œ eslint --fixï¼‰

- husky â€”â€” Git Hook å·¥å…·ï¼Œå¯ä»¥è®¾ç½®åœ¨ git å„ä¸ªé˜¶æ®µï¼ˆpre-commitã€commit-msgã€pre-push ç­‰ï¼‰è§¦å‘æˆ‘ä»¬çš„å‘½ä»¤ã€‚
- lint-staged â€”â€” åœ¨ git æš‚å­˜çš„æ–‡ä»¶ä¸Šè¿è¡Œ lintersã€‚

**é…ç½® husky**

```javascript
npx husky-init && npm install
```

ä¿®æ”¹ `.husky/pre-commit` hook æ–‡ä»¶çš„è§¦å‘å‘½ä»¤ï¼š

```javascript
eslint --fix ./src --ext .vue,.js,.ts
```

**é…ç½® lint-staged**

lint-staged è¿™ä¸ªå·¥å…·ä¸€èˆ¬ç»“åˆ husky æ¥ä½¿ç”¨ï¼Œå®ƒå¯ä»¥è®© husky çš„ hook è§¦å‘çš„å‘½ä»¤åªä½œç”¨äº git add é‚£äº›æ–‡ä»¶ï¼ˆå³ git æš‚å­˜åŒºçš„æ–‡ä»¶ï¼‰ï¼Œè€Œä¸ä¼šå½±å“åˆ°å…¶ä»–æ–‡ä»¶ã€‚

å®‰è£… lint-staged

```javascript
npm i lint-staged -D
```

åœ¨ package.json é‡Œå¢åŠ  lint-staged é…ç½®é¡¹

```javascript
"lint-staged": {
  "*.{vue,js,ts}": "eslint --fix"
},
```

ä¿®æ”¹ `.husky/pre-commit` hook çš„è§¦å‘å‘½ä»¤ä¸ºï¼š`npx lint-staged`

è¯¦ç»†æ“ä½œè§å‚è€ƒé“¾æ¥

---

> å‚è€ƒé“¾æ¥
>
> [ESLint å¼€å§‹ï¼Œè¯´é€æˆ‘å¦‚ä½•åœ¨å›¢é˜Ÿé¡¹ç›®ä¸­åŸºäº Vue åšä»£ç æ ¡éªŒ](https://juejin.cn/post/6974223481181306888#heading-26)
